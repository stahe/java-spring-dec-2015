
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Introduction au langage Java et à l'écosystème Spring au travers d'une étude de cas">
      
      
        <meta name="author" content="Serge Tahé">
      
      
        <link rel="canonical" href="https://stahe.github.io/java-spring-dec-2015/cours-introduction-au-framework-spring.html">
      
      
        <link rel="prev" href="td-architectures-en-couches.html">
      
      
        <link rel="next" href="cours-introduction-a-lapi-jdbc.html">
      
      
        
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>5. [Cours] : Introduction au framework Spring - Introduction au langage Java et à l'écosystème Spring au travers d'une étude de cas</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="stylesheets/focus.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#5-cours-introduction-au-framework-spring" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="Introduction au langage Java et à l&#39;écosystème Spring au travers d&#39;une étude de cas" class="md-header__button md-logo" aria-label="Introduction au langage Java et à l'écosystème Spring au travers d'une étude de cas" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Introduction au langage Java et à l'écosystème Spring au travers d'une étude de cas
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              5. [Cours] : Introduction au framework Spring
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Passer au mode sombre"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Passer au mode sombre" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Passer au mode clair"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Passer au mode clair" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/stahe/java-spring-dec-2015" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Introduction au langage Java et à l&#39;écosystème Spring au travers d&#39;une étude de cas" class="md-nav__button md-logo" aria-label="Introduction au langage Java et à l'écosystème Spring au travers d'une étude de cas" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Introduction au langage Java et à l'écosystème Spring au travers d'une étude de cas
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/stahe/java-spring-dec-2015" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Accueil
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="introduction.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1. Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="td-le-probleme.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2. [TD] : Le problème
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="td-classes.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3. [TD] : Classes
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="td-architectures-en-couches.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4. [TD] : Architectures en couches
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    5. [Cours] : Introduction au framework Spring
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="cours-introduction-au-framework-spring.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    5. [Cours] : Introduction au framework Spring
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#51-support" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1. Support
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#52-exemple-01" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2. Exemple-01
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.2. Exemple-01">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#521-le-projet-eclipse" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2.1. Le projet Eclipse
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#522-la-classe-personne" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2.2. La classe [Personne]
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#523-la-classe-appartement" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2.3. La classe [Appartement]
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#524-le-fichier-de-configuration-de-spring" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2.4. Le fichier de configuration de Spring
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#525-la-classe-executable" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2.5. La classe exécutable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#526-les-dependances-du-projet" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2.6. Les dépendances du projet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#527-les-resultats" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2.7. Les résultats
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#53-exemple-02" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3. Exemple-02
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.3. Exemple-02">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#531-le-projet-eclipse" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3.1. Le projet Eclipse
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#532-la-classe-de-configuration-de-spring" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3.2. La classe de configuration de Spring
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#533-la-classe-executable" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3.3. La classe exécutable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#534-les-dependances-du-projet" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3.4. Les dépendances du projet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#535-generation-de-lartifact-maven-du-projet" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3.5. Génération de l'artifact Maven du projet
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#54-exemple-03" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4. Exemple-03
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.4. Exemple-03">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#541-le-projet-eclipse" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4.1. Le projet Eclipse
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#542-la-configuration-maven" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4.2. La configuration Maven
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#543-la-classe-de-configuration-de-spring" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4.3. La classe de configuration de Spring
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#544-la-classe-appartement" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4.4. La classe [Appartement]
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#545-execution-du-projet" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4.5. Exécution du projet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#546-generation-de-larchive-du-projet-avec-ses-dependances" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4.6. Génération de l'archive du projet avec ses dépendances
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#55-exemple-04" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.5. Exemple-04
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.5. Exemple-04">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#551-objectif" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.5.1. Objectif
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#552-le-projet-eclipse" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.5.2. Le projet Eclipse
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.5.2. Le projet Eclipse">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#5521-generation" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.5.2.1. Génération
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5522-la-classe-executable" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.5.2.2. La classe exécutable
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#553-implementation-des-differentes-couches-de-larchitecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.5.3. Implémentation des différentes couches de l'architecture
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#554-configuration-du-projet-spring" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.5.4. Configuration du projet Spring
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#555-test-unitaire-junittest" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.5.5. Test unitaire [JUnitTest]
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#56-conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.6. Conclusion
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="cours-introduction-a-lapi-jdbc.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    6. [Cours] : Introduction à l'API JDBC
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="td-implementation-de-la-couche-dao-du-td-avec-lapi-jdbc.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    7. [TD] : Implémentation de la couche [DAO] du TD avec l'API JDBC
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="td-la-couche-metier.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    8. [TD] : La couche [metier]
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="td-implementation-de-la-couche-ui-avec-un-programme-console.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    9. [TD] : Implémentation de la couche [ui] avec un programme console
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="td-implementation-de-la-couche-ui-avec-une-interface-swing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    10. [TD] : Implémentation de la couche [ui] avec une interface Swing
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="cours-gestion-des-bases-de-donnees-relationnelles-avec-spring-data.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    11. [Cours] : Gestion des bases de données relationnelles avec Spring Data
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="td-implementation-de-la-couche-dao-du-td-avec-spring-data.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    12. [TD] : Implémentation de la couche [DAO] du TD avec [Spring Data]
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="cours-exposer-une-base-de-donnees-sur-le-web-avec-spring-mvc.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    13. [Cours] : Exposer une base de données sur le web avec Spring MVC
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="td-exposition-sur-le-web-de-la-couche-metier.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    14. [TD] : Exposition sur le web de la couche [metier]
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="td-creation-dun-client-pour-le-service-web.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    15. [TD] : création d'un client pour le service web
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="cours-securiser-lacces-a-un-service-web-avec-spring-security.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    16. [Cours] : Sécuriser l'accès à un service web avec Spring Security
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="td-securisation-du-serveur-web--json-des-elections.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    17. [TD] : sécurisation du serveur web / jSON des élections
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="cours-gestion-des-acces-inter-domaines.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    18. [Cours] : Gestion des accès inter-domaines
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="td-elections-avec-des-requetes-inter-domaines.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    19. [TD] Elections avec des requêtes inter-domaines
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="programmation-asynchrone-avec-rxjava.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    20. Programmation asynchrone avec RxJava
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="conclusion.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    21. Conclusion
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="annexes.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    22. Annexes
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="5-cours-introduction-au-framework-spring">5. [Cours] : Introduction au framework Spring</h1>
<p><strong>Mots clés</strong> : architecture multicouche, Spring, injection de dépendances.</p>
<p>Spring est apparu en 2004 d'abord en tant que <strong>conteneur d'objets</strong>. Depuis, il a évolué en de multiple ramifications : Spring MVC, Spring Data, Spring Batch, ... [<a href="http://spring.io/"><u>http://spring.io</u></a>]. Nous ne présentons dans ce chapitre que le conteneur d'objets. Voici quelques points de repère :</p>
<ul>
<li>une application a de multiples classes et certaines d'entre-elles se partagent des objets qui doivent être uniques (singletons). Spring crée et gère ces singletons ;</li>
<li>Spring place ces singletons dans une structure appelée <strong>contexte</strong> ;</li>
<li>les classes ont accès aux singletons de l'application en les demandant à Spring via leur nom, leur type ou les deux ;</li>
<li>Spring crée les singletons et gère leurs dépendances éventuelles : un singleton peut en effet avoir des références sur un ou plusieurs autres singletons. Lorsque Spring crée un singleton, il crée également leurs dépendances ;</li>
<li>lorsqu'une application s'appuyant sur Spring démarre, elle peut demander à Spring de créer tous les singletons de l'application. Ceux-ci seront ensuite disponibles dans le contexte de Spring ;</li>
<li>Spring facilite l'utilisation des <strong>architectures en couches</strong> et la <strong>programmation par interfaces</strong>. Dans les cas simples, chaque couche est implémentée par un singleton et implémente une interface. Si l'application travaille avec les interfaces des couches et non avec leurs classes d'implémentation, alors on obtient une architecture évolutive qui permet de changer l'implémentation d'une couche sans changer les autres grâce aux deux caractéristiques suivantes :</li>
<li>l'application obtient une référence sur la couche via son nom. Spring lui délivre une référence sur la classe implémentant la couche ;</li>
<li>l'application utilise cette référence comme celle de l'interface de la couche et non comme celle d'une classe ;</li>
</ul>
<p>La déclaration des singletons peut être faite de trois façons qui peuvent être mixées :</p>
<ul>
<li>au sein d'un fichier XML,</li>
<li>dans une classe spéciale de configuration ;</li>
<li>avec toute classe à l'aide d'annotations ;</li>
</ul>
<p>Nous présentons dans la suite trois exemples de configuration :</p>
<ul>
<li>[exemple-01] : configuration centralisée dans un unique fichier XML ;</li>
<li>[exemple-02] : configuration centralisée dans une unique classe Java ;</li>
<li>[exemple-03] : configuration distribuée sur plusieurs classes Java ;</li>
</ul>
<p>Le dernier exemple [exemple-04] s'intéresse à la configuration Spring d'une architecture en couches. C'est l'exemple le plus important. C'est lui qui sera repris constamment pour configurer les architectures du document.</p>
<p>Ces quatre exemples posent les bases de ce qui suit :</p>
<ul>
<li>configuration Spring et injection de dépendances ;</li>
<li>utilisation de Maven pour gérer les dépendances d'un projet ;</li>
<li>utilisation de JUnit pour tester les projets ;</li>
</ul>
<h2 id="51-support">5.1. Support</h2>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000000B4000000C9831547A3.png" style="display:inline-block; margin:4px;width:3.33cm;height:3.72cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000000A4000000B4309421B7.png" style="display:inline-block; margin:4px;width:3.039cm;height:3.33cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr></table>

<p>Le dossier [support / chap-05] contient les projets Eclipse de ce chapitre.</p>
<h2 id="52-exemple-01">5.2. Exemple-01</h2>
<h3 id="521-le-projet-eclipse">5.2.1. Le projet Eclipse</h3>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000010B0000010FD8A8CC23.png" style="display:inline-block; margin:4px;width:4.941cm;height:5.02cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr></table>

<h3 id="522-la-classe-personne">5.2.2. La classe [Personne]</h3>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000000F0000000B266BEDF19.png" style="display:inline-block; margin:4px;width:4.45cm;height:3.3cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr></table>

<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a>package istia.st.spring.core;
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>public class Personne {
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>    // champs
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>    private String nom;
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>    private String prenom;
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>    private int age;
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>    // constructeurs
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    public Personne() {
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    }
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    public Personne(String nom, String prénom, int âge) {
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>        this.nom = nom;
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>        this.prenom = prénom;
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>        this.age = âge;
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    }
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    // toString
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    public String toString() {
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>        return String.format(&quot;Personne[%s, %s,%d]&quot;, prenom, nom, age);
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    }
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>    // getters et setters
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    public String getNom() {
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>        return nom;
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    }
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    public void setNom(String nom) {
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>        this.nom = nom;
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    }
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    public String getPrenom() {
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>        return prenom;
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    }
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    public void setPrenom(String prenom) {
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>        this.prenom = prenom;
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    }
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    public int getAge() {
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>        return age;
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    }
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    public void setAge(int age) {
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        this.age = age;
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    }
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>}
</code></pre></div></td></tr></table></div>
<p><strong>Note</strong> : les getters et setters peuvent être générés automatiquement de la façon suivante [1-2] :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000053D0000037E5236C820.png" style="display:inline-block; margin:4px;width:10.64cm;height:7.1cm;" /></td></tr></table>

<h3 id="523-la-classe-appartement">5.2.3. La classe [Appartement]</h3>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000000F0000000B26DE089CA.png" style="display:inline-block; margin:4px;width:4.45cm;height:3.3cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr></table>

<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span>
<span class="normal"><a href="#__codelineno-1-11">11</a></span>
<span class="normal"><a href="#__codelineno-1-12">12</a></span>
<span class="normal"><a href="#__codelineno-1-13">13</a></span>
<span class="normal"><a href="#__codelineno-1-14">14</a></span>
<span class="normal"><a href="#__codelineno-1-15">15</a></span>
<span class="normal"><a href="#__codelineno-1-16">16</a></span>
<span class="normal"><a href="#__codelineno-1-17">17</a></span>
<span class="normal"><a href="#__codelineno-1-18">18</a></span>
<span class="normal"><a href="#__codelineno-1-19">19</a></span>
<span class="normal"><a href="#__codelineno-1-20">20</a></span>
<span class="normal"><a href="#__codelineno-1-21">21</a></span>
<span class="normal"><a href="#__codelineno-1-22">22</a></span>
<span class="normal"><a href="#__codelineno-1-23">23</a></span>
<span class="normal"><a href="#__codelineno-1-24">24</a></span>
<span class="normal"><a href="#__codelineno-1-25">25</a></span>
<span class="normal"><a href="#__codelineno-1-26">26</a></span>
<span class="normal"><a href="#__codelineno-1-27">27</a></span>
<span class="normal"><a href="#__codelineno-1-28">28</a></span>
<span class="normal"><a href="#__codelineno-1-29">29</a></span>
<span class="normal"><a href="#__codelineno-1-30">30</a></span>
<span class="normal"><a href="#__codelineno-1-31">31</a></span>
<span class="normal"><a href="#__codelineno-1-32">32</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a>package istia.st.spring.core;
<a id="__codelineno-1-2" name="__codelineno-1-2"></a>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a>public class Appartement {
<a id="__codelineno-1-4" name="__codelineno-1-4"></a>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a>    // champs
<a id="__codelineno-1-6" name="__codelineno-1-6"></a>    private Personne proprietaire;
<a id="__codelineno-1-7" name="__codelineno-1-7"></a>    private int surface;
<a id="__codelineno-1-8" name="__codelineno-1-8"></a>
<a id="__codelineno-1-9" name="__codelineno-1-9"></a>    // getters et setters
<a id="__codelineno-1-10" name="__codelineno-1-10"></a>
<a id="__codelineno-1-11" name="__codelineno-1-11"></a>    public Personne getProprietaire() {
<a id="__codelineno-1-12" name="__codelineno-1-12"></a>        return proprietaire;
<a id="__codelineno-1-13" name="__codelineno-1-13"></a>    }
<a id="__codelineno-1-14" name="__codelineno-1-14"></a>
<a id="__codelineno-1-15" name="__codelineno-1-15"></a>    public void setProprietaire(Personne proprietaire) {
<a id="__codelineno-1-16" name="__codelineno-1-16"></a>        this.proprietaire = proprietaire;
<a id="__codelineno-1-17" name="__codelineno-1-17"></a>    }
<a id="__codelineno-1-18" name="__codelineno-1-18"></a>
<a id="__codelineno-1-19" name="__codelineno-1-19"></a>    public int getSurface() {
<a id="__codelineno-1-20" name="__codelineno-1-20"></a>        return surface;
<a id="__codelineno-1-21" name="__codelineno-1-21"></a>    }
<a id="__codelineno-1-22" name="__codelineno-1-22"></a>
<a id="__codelineno-1-23" name="__codelineno-1-23"></a>    public void setSurface(int surface) {
<a id="__codelineno-1-24" name="__codelineno-1-24"></a>        this.surface = surface;
<a id="__codelineno-1-25" name="__codelineno-1-25"></a>    }
<a id="__codelineno-1-26" name="__codelineno-1-26"></a>
<a id="__codelineno-1-27" name="__codelineno-1-27"></a>    // toString
<a id="__codelineno-1-28" name="__codelineno-1-28"></a>    public String toString() {
<a id="__codelineno-1-29" name="__codelineno-1-29"></a>        return String.format(&quot;Appartement[%s, %s]&quot;, proprietaire, surface);
<a id="__codelineno-1-30" name="__codelineno-1-30"></a>    }
<a id="__codelineno-1-31" name="__codelineno-1-31"></a>
<a id="__codelineno-1-32" name="__codelineno-1-32"></a>}
</code></pre></div></td></tr></table></div>
<p><strong>Note</strong> : cette classe n'a pas de constructeur explicite. Dans ce cas, existe toujours par défaut, le constructeur sans paramètres qui ne fait rien. Lorsqu'on crée des constructeurs, ce constructeur par défaut n'existe plus implicitement. Il faut alors le définir <strong>explicitement</strong> :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span>
<span class="normal"><a href="#__codelineno-2-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a>public Appartement(){
<a id="__codelineno-2-2" name="__codelineno-2-2"></a>}
</code></pre></div></td></tr></table></div>
<h3 id="524-le-fichier-de-configuration-de-spring">5.2.4. Le fichier de configuration de Spring</h3>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000000F0000000B2C381C588.png" style="display:inline-block; margin:4px;width:4.45cm;height:3.3cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr></table>

<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-3-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-3-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-3-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-3-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-3-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-3-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-3-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-3-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-3-10">10</a></span>
<span class="normal"><a href="#__codelineno-3-11">11</a></span>
<span class="normal"><a href="#__codelineno-3-12">12</a></span>
<span class="normal"><a href="#__codelineno-3-13">13</a></span>
<span class="normal"><a href="#__codelineno-3-14">14</a></span>
<span class="normal"><a href="#__codelineno-3-15">15</a></span>
<span class="normal"><a href="#__codelineno-3-16">16</a></span>
<span class="normal"><a href="#__codelineno-3-17">17</a></span>
<span class="normal"><a href="#__codelineno-3-18">18</a></span>
<span class="normal"><a href="#__codelineno-3-19">19</a></span>
<span class="normal"><a href="#__codelineno-3-20">20</a></span>
<span class="normal"><a href="#__codelineno-3-21">21</a></span>
<span class="normal"><a href="#__codelineno-3-22">22</a></span>
<span class="normal"><a href="#__codelineno-3-23">23</a></span>
<span class="normal"><a href="#__codelineno-3-24">24</a></span>
<span class="normal"><a href="#__codelineno-3-25">25</a></span>
<span class="normal"><a href="#__codelineno-3-26">26</a></span>
<span class="normal"><a href="#__codelineno-3-27">27</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="nt">&lt;beans</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;http://www.springframework.org/schema/beans&quot;</span><span class="w"> </span><span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span class="w"> </span><span class="na">xmlns:util=</span><span class="s">&quot;http://www.springframework.org/schema/util&quot;</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="w">    </span><span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.0.xsd</span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="s">        http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-4.0.xsd&quot;</span><span class="nt">&gt;</span>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="w">    </span><span class="cm">&lt;!-- Personne 01 --&gt;</span>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="w">    </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;personne_01&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;istia.st.spring.core.Personne&quot;</span><span class="nt">&gt;</span>
<a id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="w">        </span><span class="nt">&lt;constructor-arg</span><span class="w"> </span><span class="na">index=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;dubois&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<a id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="w">        </span><span class="nt">&lt;constructor-arg</span><span class="w"> </span><span class="na">index=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;paul&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<a id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="w">        </span><span class="nt">&lt;constructor-arg</span><span class="w"> </span><span class="na">index=</span><span class="s">&quot;2&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;34&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<a id="__codelineno-3-10" name="__codelineno-3-10"></a><span class="w">    </span><span class="nt">&lt;/bean&gt;</span>
<a id="__codelineno-3-11" name="__codelineno-3-11"></a><span class="w">    </span><span class="cm">&lt;!-- Personne 02 --&gt;</span>
<a id="__codelineno-3-12" name="__codelineno-3-12"></a><span class="w">    </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;personne_02&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;istia.st.spring.core.Personne&quot;</span><span class="nt">&gt;</span>
<a id="__codelineno-3-13" name="__codelineno-3-13"></a><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;nom&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;martin&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<a id="__codelineno-3-14" name="__codelineno-3-14"></a><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;prenom&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;micheline&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<a id="__codelineno-3-15" name="__codelineno-3-15"></a><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;age&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;18&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<a id="__codelineno-3-16" name="__codelineno-3-16"></a><span class="w">    </span><span class="nt">&lt;/bean&gt;</span>
<a id="__codelineno-3-17" name="__codelineno-3-17"></a><span class="w">    </span><span class="cm">&lt;!-- une liste de personnes --&gt;</span>
<a id="__codelineno-3-18" name="__codelineno-3-18"></a><span class="w">    </span><span class="nt">&lt;util:list</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;club&quot;</span><span class="nt">&gt;</span>
<a id="__codelineno-3-19" name="__codelineno-3-19"></a><span class="w">        </span><span class="nt">&lt;ref</span><span class="w"> </span><span class="na">bean=</span><span class="s">&quot;personne_01&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<a id="__codelineno-3-20" name="__codelineno-3-20"></a><span class="w">        </span><span class="nt">&lt;ref</span><span class="w"> </span><span class="na">bean=</span><span class="s">&quot;personne_02&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<a id="__codelineno-3-21" name="__codelineno-3-21"></a><span class="w">    </span><span class="nt">&lt;/util:list&gt;</span>
<a id="__codelineno-3-22" name="__codelineno-3-22"></a><span class="w">    </span><span class="cm">&lt;!-- un appartement --&gt;</span>
<a id="__codelineno-3-23" name="__codelineno-3-23"></a><span class="w">    </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;appartement&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;istia.st.spring.core.Appartement&quot;</span><span class="nt">&gt;</span>
<a id="__codelineno-3-24" name="__codelineno-3-24"></a><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;surface&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;100&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<a id="__codelineno-3-25" name="__codelineno-3-25"></a><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;proprietaire&quot;</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;personne_01&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<a id="__codelineno-3-26" name="__codelineno-3-26"></a><span class="w">    </span><span class="nt">&lt;/bean&gt;</span>
<a id="__codelineno-3-27" name="__codelineno-3-27"></a><span class="nt">&lt;/beans&gt;</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>lignes 2, 27 : les singletons sont définis au sein d'une balise &lt;<strong>beans</strong>&gt; ;</li>
<li>lignes 6-10 : chaque singleton est défini par une balise &lt;<strong>bean</strong>&gt; ;</li>
<li>ligne 6 : [id] est l'identifiant du singleton. [class] est le nom complet de la classe à instancier ;</li>
<li>lignes 7-9 : les trois valeurs à passer au constructeur de la classe [Personne] ;</li>
<li>lignes 12-16 : la classe [Personne] est d'abord créée avec son constructeur par défaut [new Personne()]. Puis pour chaque balise [property], un setter de la classe est utilisé. Par exemple pour la ligne 13, la méthode [<strong>setNom</strong>("martin")] va être exécutée. Il faut donc que la méthode [<strong>setNom</strong>] existe. C'est un point important à se rappeler ;</li>
<li>lignes 18-21 : la balise &lt;util:list&gt; permet de définir un singleton qui est une liste ;</li>
<li>ligne 19 : désigne le singleton [personne_01] défini ligne 6. On a là ce qu'on appelle une <strong>injection de dépendances</strong>. Deux attributs sont utilisables pour initialiser le champ d'un singleton :</li>
<li>[value] : pour affecter au champ une valeur primitive (chaîne, nombre, date, ...),</li>
<li>[ref] : pour affecter au champ la référence d'un objet Spring ;</li>
</ul>
<p><strong>Note</strong> : le fichier de configuration Spring peut être généré de la façon suivante [1-4] :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000063C00000454195FBF13.png" style="display:inline-block; margin:4px;width:17.999cm;height:12.494cm;" /></td></tr></table>

<h3 id="525-la-classe-executable">5.2.5. La classe exécutable</h3>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000000F0000000B2DC91E73C.png" style="display:inline-block; margin:4px;width:4.45cm;height:3.3cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr></table>

<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span>
<span class="normal"><a href="#__codelineno-4-15">15</a></span>
<span class="normal"><a href="#__codelineno-4-16">16</a></span>
<span class="normal"><a href="#__codelineno-4-17">17</a></span>
<span class="normal"><a href="#__codelineno-4-18">18</a></span>
<span class="normal"><a href="#__codelineno-4-19">19</a></span>
<span class="normal"><a href="#__codelineno-4-20">20</a></span>
<span class="normal"><a href="#__codelineno-4-21">21</a></span>
<span class="normal"><a href="#__codelineno-4-22">22</a></span>
<span class="normal"><a href="#__codelineno-4-23">23</a></span>
<span class="normal"><a href="#__codelineno-4-24">24</a></span>
<span class="normal"><a href="#__codelineno-4-25">25</a></span>
<span class="normal"><a href="#__codelineno-4-26">26</a></span>
<span class="normal"><a href="#__codelineno-4-27">27</a></span>
<span class="normal"><a href="#__codelineno-4-28">28</a></span>
<span class="normal"><a href="#__codelineno-4-29">29</a></span>
<span class="normal"><a href="#__codelineno-4-30">30</a></span>
<span class="normal"><a href="#__codelineno-4-31">31</a></span>
<span class="normal"><a href="#__codelineno-4-32">32</a></span>
<span class="normal"><a href="#__codelineno-4-33">33</a></span>
<span class="normal"><a href="#__codelineno-4-34">34</a></span>
<span class="normal"><a href="#__codelineno-4-35">35</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">istia.st.spring.core</span><span class="p">;</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.ArrayList</span><span class="p">;</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.ApplicationContext</span><span class="p">;</span>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.support.ClassPathXmlApplicationContext</span><span class="p">;</span>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Demo01</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-10" name="__codelineno-4-10"></a>
<a id="__codelineno-4-11" name="__codelineno-4-11"></a><span class="w">    </span><span class="nd">@SuppressWarnings</span><span class="p">({</span><span class="w"> </span><span class="s">&quot;unchecked&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;resource&quot;</span><span class="w"> </span><span class="p">})</span>
<a id="__codelineno-4-12" name="__codelineno-4-12"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-13" name="__codelineno-4-13"></a><span class="w">        </span><span class="c1">// récupération du contexte Spring</span>
<a id="__codelineno-4-14" name="__codelineno-4-14"></a><span class="w">        </span><span class="n">ApplicationContext</span><span class="w"> </span><span class="n">ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ClassPathXmlApplicationContext</span><span class="p">(</span><span class="s">&quot;config-01.xml&quot;</span><span class="p">);</span>
<a id="__codelineno-4-15" name="__codelineno-4-15"></a><span class="w">        </span><span class="c1">// on récupère les beans</span>
<a id="__codelineno-4-16" name="__codelineno-4-16"></a><span class="w">        </span><span class="n">Personne</span><span class="w"> </span><span class="n">p01</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="s">&quot;personne_01&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Personne</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<a id="__codelineno-4-17" name="__codelineno-4-17"></a><span class="w">        </span><span class="n">Personne</span><span class="w"> </span><span class="n">p02</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="s">&quot;personne_02&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Personne</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<a id="__codelineno-4-18" name="__codelineno-4-18"></a><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Personne</span><span class="o">&gt;</span><span class="w"> </span><span class="n">club</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="s">&quot;club&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Personne</span><span class="o">&gt;</span><span class="p">().</span><span class="na">getClass</span><span class="p">());</span>
<a id="__codelineno-4-19" name="__codelineno-4-19"></a><span class="w">        </span><span class="n">Appartement</span><span class="w"> </span><span class="n">appart01</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">Appartement</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<a id="__codelineno-4-20" name="__codelineno-4-20"></a><span class="w">        </span><span class="c1">// on les affiche</span>
<a id="__codelineno-4-21" name="__codelineno-4-21"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;personnes--------&quot;</span><span class="p">);</span>
<a id="__codelineno-4-22" name="__codelineno-4-22"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">p01</span><span class="p">);</span>
<a id="__codelineno-4-23" name="__codelineno-4-23"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">p02</span><span class="p">);</span>
<a id="__codelineno-4-24" name="__codelineno-4-24"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;club--------&quot;</span><span class="p">);</span>
<a id="__codelineno-4-25" name="__codelineno-4-25"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Personne</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">club</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-26" name="__codelineno-4-26"></a><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<a id="__codelineno-4-27" name="__codelineno-4-27"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-4-28" name="__codelineno-4-28"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;appartement--------&quot;</span><span class="p">);</span>
<a id="__codelineno-4-29" name="__codelineno-4-29"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">appart01</span><span class="p">);</span>
<a id="__codelineno-4-30" name="__codelineno-4-30"></a><span class="w">        </span><span class="c1">// les beans récupérés sont des singletons</span>
<a id="__codelineno-4-31" name="__codelineno-4-31"></a><span class="w">        </span><span class="c1">// on peut les demander plusieurs fois, on récupère toujours le même bean</span>
<a id="__codelineno-4-32" name="__codelineno-4-32"></a><span class="w">        </span><span class="n">Personne</span><span class="w"> </span><span class="n">p01b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="s">&quot;personne_01&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Personne</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<a id="__codelineno-4-33" name="__codelineno-4-33"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="s">&quot;beans [p01,p01b] identiques ? %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p01b</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">p01</span><span class="p">));</span>
<a id="__codelineno-4-34" name="__codelineno-4-34"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-4-35" name="__codelineno-4-35"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 14 : crée le contexte Spring. Tous les singletons définis dans le fichier [config-01.xml] sont alors instanciés ;</li>
<li>ligne 16 : demande une référence sur le singleton identifié par [personne_01] de type [Personne]. Ce second paramètre est facultatif mais alors on reçoit une référence sur un type [Object], référence qu'il faut alors transtyper vers le type [Personne] ;</li>
<li>ligne 19 : on n'utilise pas le nom du bean mais uniquement son type car il n'y a qu'un singleton de type [Appartement] ;</li>
<li>ligne 18 : on a utilisé à la fois l'identifiant et le type du singleton désiré. L'identifiant est superflu puisque qu'il n'y a qu'un singleton de type [<strong>new</strong> ArrayList&lt;Personne&gt;().getClass()] ;</li>
<li>lignes 32-33 : montrent que si on demande plusieurs fois le même singleton, on obtient bien toujours la même référence, montrant par là qu'on a bien affaire à un singleton. Ce point est important à comprendre ;</li>
</ul>
<p><strong>Note</strong> : une classe exécutable peut être générée de la façon suivante [1-6] :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/1000000000000480000002287489348E.png" style="display:inline-block; margin:4px;width:15.24cm;height:7.303cm;" /></td></tr></table>

<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/1000000000000375000003148D450C5D.png" style="display:inline-block; margin:4px;width:11.709cm;height:10.425cm;" /></td></tr></table>

<ul>
<li>c'est le fait de cocher [6] qui va faire que la classe générée va contenir une méthode statique [main] qui va la rendre exécutable ;</li>
</ul>
<h3 id="526-les-dependances-du-projet">5.2.6. Les dépendances du projet</h3>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000011D000001401CAF2AA2.png" style="display:inline-block; margin:4px;width:5.241cm;height:5.92cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr></table>

<ul>
<li>dépendances Spring : [spring-core, spring-beans, spring-context, spring-expression, commons-logging] ;</li>
</ul>
<p>Les dépendances sont ajoutées au projet de la façon suivante :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/1000000000000381000002A8CF759027.png" style="display:inline-block; margin:4px;width:11.867cm;height:8.996cm;" /></td></tr></table>

<ul>
<li>en [1] : clic droit sur le projet / [Build Path] / [Configure Build Path] ;</li>
</ul>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000038A0000013FB29E77D9.png" style="display:inline-block; margin:4px;width:11.986cm;height:4.221cm;" /></td></tr></table>

<ul>
<li>en [2] : [Add JARs] si les JARs à ajouter sont dans un dossier du projet. Sinon [Add External JARs] ;</li>
</ul>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000001DA000001B90B0E735E.png" style="display:inline-block; margin:4px;width:6.271cm;height:5.835cm;" /></td></tr></table>

<ul>
<li>en [3], sélectionnez les JARs à ajouter au ClassPath du projet (ils sont ici dans le dossier [lib] à l'intérieur du projet) ;</li>
</ul>
<p><strong>Définition</strong> : le [ClassPath] d'un projet est l'ensemble des dossiers explorés par la JVM (Java Virtual Machine) qui exécute le projet, pour trouver une classe référencée par celui-ci. Pour un projet Eclipse, le [ClassPath] est formé des éléments suivants :</p>
<ul>
<li>le dossier [bin] du projet ;</li>
<li>les éléments du [Build Path] du projet ;</li>
</ul>
<p>Le dossier [bin] est le dossier produit par la compilation du dossier [src]. Donc tout ce qui est placé dans le dossier [src] fait automatiquement partie du [ClassPath] (même si ce n'est pas un fichier .java). Donc dans le projet précédent, le fichier de configuration de spring [config-01.xml] qui est dans le dossier [src] fera partie du [Classpath] du projet à l'exécution.</p>
<h3 id="527-les-resultats">5.2.7. Les résultats</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-5-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-5-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-5-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-5-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-5-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-5-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-5-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-5-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-5-10">10</a></span>
<span class="normal"><a href="#__codelineno-5-11">11</a></span>
<span class="normal"><a href="#__codelineno-5-12">12</a></span>
<span class="normal"><a href="#__codelineno-5-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a>févr. 21, 2014 1:16:23 PM org.springframework.context.support.AbstractApplicationContext prepareRefresh
<a id="__codelineno-5-2" name="__codelineno-5-2"></a>Infos: Refreshing org.springframework.context.support.ClassPathXmlApplicationContext@3ac67f69: startup date [Fri Feb 21 13:16:23 CET 2014]; root of context hierarchy
<a id="__codelineno-5-3" name="__codelineno-5-3"></a>févr. 21, 2014 1:16:23 PM org.springframework.beans.factory.xml.XmlBeanDefinitionReader loadBeanDefinitions
<a id="__codelineno-5-4" name="__codelineno-5-4"></a>Infos: Loading XML bean definitions from class path resource [config-01.xml]
<a id="__codelineno-5-5" name="__codelineno-5-5"></a>personnes--------
<a id="__codelineno-5-6" name="__codelineno-5-6"></a>Personne[paul, dubois,34]
<a id="__codelineno-5-7" name="__codelineno-5-7"></a>Personne[micheline, martin,18]
<a id="__codelineno-5-8" name="__codelineno-5-8"></a>club--------
<a id="__codelineno-5-9" name="__codelineno-5-9"></a>Personne[paul, dubois,34]
<a id="__codelineno-5-10" name="__codelineno-5-10"></a>Personne[micheline, martin,18]
<a id="__codelineno-5-11" name="__codelineno-5-11"></a>appartement--------
<a id="__codelineno-5-12" name="__codelineno-5-12"></a>Appartement[Personne[paul, dubois,34], 100]
<a id="__codelineno-5-13" name="__codelineno-5-13"></a>beans [p01,p01b] identiques ? true
</code></pre></div></td></tr></table></div>
<h2 id="53-exemple-02">5.3. Exemple-02</h2>
<h3 id="531-le-projet-eclipse">5.3.1. Le projet Eclipse</h3>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000000D0000000DA1E6B6DC4.png" style="display:inline-block; margin:4px;width:3.87cm;height:4.039cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr></table>

<h3 id="532-la-classe-de-configuration-de-spring">5.3.2. La classe de configuration de Spring</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-6-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-6-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-6-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-6-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-6-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-6-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-6-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-6-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-6-10">10</a></span>
<span class="normal"><a href="#__codelineno-6-11">11</a></span>
<span class="normal"><a href="#__codelineno-6-12">12</a></span>
<span class="normal"><a href="#__codelineno-6-13">13</a></span>
<span class="normal"><a href="#__codelineno-6-14">14</a></span>
<span class="normal"><a href="#__codelineno-6-15">15</a></span>
<span class="normal"><a href="#__codelineno-6-16">16</a></span>
<span class="normal"><a href="#__codelineno-6-17">17</a></span>
<span class="normal"><a href="#__codelineno-6-18">18</a></span>
<span class="normal"><a href="#__codelineno-6-19">19</a></span>
<span class="normal"><a href="#__codelineno-6-20">20</a></span>
<span class="normal"><a href="#__codelineno-6-21">21</a></span>
<span class="normal"><a href="#__codelineno-6-22">22</a></span>
<span class="normal"><a href="#__codelineno-6-23">23</a></span>
<span class="normal"><a href="#__codelineno-6-24">24</a></span>
<span class="normal"><a href="#__codelineno-6-25">25</a></span>
<span class="normal"><a href="#__codelineno-6-26">26</a></span>
<span class="normal"><a href="#__codelineno-6-27">27</a></span>
<span class="normal"><a href="#__codelineno-6-28">28</a></span>
<span class="normal"><a href="#__codelineno-6-29">29</a></span>
<span class="normal"><a href="#__codelineno-6-30">30</a></span>
<span class="normal"><a href="#__codelineno-6-31">31</a></span>
<span class="normal"><a href="#__codelineno-6-32">32</a></span>
<span class="normal"><a href="#__codelineno-6-33">33</a></span>
<span class="normal"><a href="#__codelineno-6-34">34</a></span>
<span class="normal"><a href="#__codelineno-6-35">35</a></span>
<span class="normal"><a href="#__codelineno-6-36">36</a></span>
<span class="normal"><a href="#__codelineno-6-37">37</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">istia.st.spring.core</span><span class="p">;</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.ArrayList</span><span class="p">;</span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>
<a id="__codelineno-6-5" name="__codelineno-6-5"></a>
<a id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Bean</span><span class="p">;</span>
<a id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Configuration</span><span class="p">;</span>
<a id="__codelineno-6-8" name="__codelineno-6-8"></a>
<a id="__codelineno-6-9" name="__codelineno-6-9"></a><span class="nd">@Configuration</span>
<a id="__codelineno-6-10" name="__codelineno-6-10"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Config</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-11" name="__codelineno-6-11"></a>
<a id="__codelineno-6-12" name="__codelineno-6-12"></a><span class="w">    </span><span class="nd">@Bean</span>
<a id="__codelineno-6-13" name="__codelineno-6-13"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Personne</span><span class="w"> </span><span class="nf">personne_01</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-14" name="__codelineno-6-14"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Personne</span><span class="p">(</span><span class="s">&quot;Paul&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Dubois&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">34</span><span class="p">);</span>
<a id="__codelineno-6-15" name="__codelineno-6-15"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-6-16" name="__codelineno-6-16"></a>
<a id="__codelineno-6-17" name="__codelineno-6-17"></a><span class="w">    </span><span class="nd">@Bean</span>
<a id="__codelineno-6-18" name="__codelineno-6-18"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Personne</span><span class="w"> </span><span class="nf">personne_02</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-19" name="__codelineno-6-19"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Personne</span><span class="p">(</span><span class="s">&quot;Martin&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Micheline&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">18</span><span class="p">);</span>
<a id="__codelineno-6-20" name="__codelineno-6-20"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-6-21" name="__codelineno-6-21"></a>
<a id="__codelineno-6-22" name="__codelineno-6-22"></a><span class="w">    </span><span class="nd">@Bean</span>
<a id="__codelineno-6-23" name="__codelineno-6-23"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Personne</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">club</span><span class="p">(</span><span class="n">Personne</span><span class="w"> </span><span class="n">personne_01</span><span class="p">,</span><span class="w"> </span><span class="n">Personne</span><span class="w"> </span><span class="n">personne_02</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-24" name="__codelineno-6-24"></a><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Personne</span><span class="o">&gt;</span><span class="w"> </span><span class="n">personnes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Personne</span><span class="o">&gt;</span><span class="p">();</span>
<a id="__codelineno-6-25" name="__codelineno-6-25"></a><span class="w">        </span><span class="n">personnes</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">personne_01</span><span class="p">);</span>
<a id="__codelineno-6-26" name="__codelineno-6-26"></a><span class="w">        </span><span class="n">personnes</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">personne_02</span><span class="p">);</span>
<a id="__codelineno-6-27" name="__codelineno-6-27"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">personnes</span><span class="p">;</span>
<a id="__codelineno-6-28" name="__codelineno-6-28"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-6-29" name="__codelineno-6-29"></a>
<a id="__codelineno-6-30" name="__codelineno-6-30"></a><span class="w">    </span><span class="nd">@Bean</span>
<a id="__codelineno-6-31" name="__codelineno-6-31"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Appartement</span><span class="w"> </span><span class="nf">appartement</span><span class="p">(</span><span class="n">Personne</span><span class="w"> </span><span class="n">personne_01</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-32" name="__codelineno-6-32"></a><span class="w">        </span><span class="n">Appartement</span><span class="w"> </span><span class="n">appartement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Appartement</span><span class="p">();</span>
<a id="__codelineno-6-33" name="__codelineno-6-33"></a><span class="w">        </span><span class="n">appartement</span><span class="p">.</span><span class="na">setSurface</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>
<a id="__codelineno-6-34" name="__codelineno-6-34"></a><span class="w">        </span><span class="n">appartement</span><span class="p">.</span><span class="na">setPropriétaire</span><span class="p">(</span><span class="n">personne_01</span><span class="p">);</span>
<a id="__codelineno-6-35" name="__codelineno-6-35"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">appartement</span><span class="p">;</span>
<a id="__codelineno-6-36" name="__codelineno-6-36"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-6-37" name="__codelineno-6-37"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 9 : l'annotation [@Configuration] est une annotation Spring. Elle indique que la classe annotée définit des singletons. Ceux-ci sont définis à l'aide de l'annotation [@Bean]. Spring va exécuter toutes les méthodes annotées par [@Bean]. Celles-ci créent les singletons de l'application ;</li>
<li>lignes 12-15 : définit un singleton identifié par [personne_01], ç-à-d le nom de la méthode.</li>
<li>ligne 23 : les paramètres [personne_01, personne_02] portent les noms de singletons. Spring va automatiquement les initialiser avec les références de ces singletons. On parle d'injection de paramètres ;</li>
</ul>
<p>Cette façon de configurer les singletons est plus explicite que celle qui utilise le fichier XML. En fait, on reproduit nous-mêmes ce que faisait Spring implicitement à partir du fichier XML.</p>
<h3 id="533-la-classe-executable">5.3.3. La classe exécutable</h3>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000000D0000000DA77333512.png" style="display:inline-block; margin:4px;width:3.851cm;height:4.039cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr></table>

<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span>
<span class="normal"><a href="#__codelineno-7-12">12</a></span>
<span class="normal"><a href="#__codelineno-7-13">13</a></span>
<span class="normal"><a href="#__codelineno-7-14">14</a></span>
<span class="normal"><a href="#__codelineno-7-15">15</a></span>
<span class="normal"><a href="#__codelineno-7-16">16</a></span>
<span class="normal"><a href="#__codelineno-7-17">17</a></span>
<span class="normal"><a href="#__codelineno-7-18">18</a></span>
<span class="normal"><a href="#__codelineno-7-19">19</a></span>
<span class="normal"><a href="#__codelineno-7-20">20</a></span>
<span class="normal"><a href="#__codelineno-7-21">21</a></span>
<span class="normal"><a href="#__codelineno-7-22">22</a></span>
<span class="normal"><a href="#__codelineno-7-23">23</a></span>
<span class="normal"><a href="#__codelineno-7-24">24</a></span>
<span class="normal"><a href="#__codelineno-7-25">25</a></span>
<span class="normal"><a href="#__codelineno-7-26">26</a></span>
<span class="normal"><a href="#__codelineno-7-27">27</a></span>
<span class="normal"><a href="#__codelineno-7-28">28</a></span>
<span class="normal"><a href="#__codelineno-7-29">29</a></span>
<span class="normal"><a href="#__codelineno-7-30">30</a></span>
<span class="normal"><a href="#__codelineno-7-31">31</a></span>
<span class="normal"><a href="#__codelineno-7-32">32</a></span>
<span class="normal"><a href="#__codelineno-7-33">33</a></span>
<span class="normal"><a href="#__codelineno-7-34">34</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">istia.st.spring.core</span><span class="p">;</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.ArrayList</span><span class="p">;</span>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>
<a id="__codelineno-7-5" name="__codelineno-7-5"></a>
<a id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.AnnotationConfigApplicationContext</span><span class="p">;</span>
<a id="__codelineno-7-7" name="__codelineno-7-7"></a>
<a id="__codelineno-7-8" name="__codelineno-7-8"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Demo02</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-9" name="__codelineno-7-9"></a>
<a id="__codelineno-7-10" name="__codelineno-7-10"></a><span class="w">    </span><span class="nd">@SuppressWarnings</span><span class="p">({</span><span class="w"> </span><span class="s">&quot;unchecked&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;resource&quot;</span><span class="w"> </span><span class="p">})</span>
<a id="__codelineno-7-11" name="__codelineno-7-11"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-12" name="__codelineno-7-12"></a><span class="w">        </span><span class="c1">// récupération du contexte Spring</span>
<a id="__codelineno-7-13" name="__codelineno-7-13"></a><span class="w">        </span><span class="n">AnnotationConfigApplicationContext</span><span class="w"> </span><span class="n">ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AnnotationConfigApplicationContext</span><span class="p">(</span><span class="n">Config</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<a id="__codelineno-7-14" name="__codelineno-7-14"></a><span class="w">        </span><span class="c1">// on récupère les beans</span>
<a id="__codelineno-7-15" name="__codelineno-7-15"></a><span class="w">        </span><span class="n">Personne</span><span class="w"> </span><span class="n">p01</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="s">&quot;personne_01&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Personne</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<a id="__codelineno-7-16" name="__codelineno-7-16"></a><span class="w">        </span><span class="n">Personne</span><span class="w"> </span><span class="n">p02</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="s">&quot;personne_02&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Personne</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<a id="__codelineno-7-17" name="__codelineno-7-17"></a><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Personne</span><span class="o">&gt;</span><span class="w"> </span><span class="n">club</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="s">&quot;club&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Personne</span><span class="o">&gt;</span><span class="p">().</span><span class="na">getClass</span><span class="p">());</span>
<a id="__codelineno-7-18" name="__codelineno-7-18"></a><span class="w">        </span><span class="n">Appartement</span><span class="w"> </span><span class="n">appart01</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">Appartement</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<a id="__codelineno-7-19" name="__codelineno-7-19"></a><span class="w">        </span><span class="c1">// on les affiche</span>
<a id="__codelineno-7-20" name="__codelineno-7-20"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;personnes--------&quot;</span><span class="p">);</span>
<a id="__codelineno-7-21" name="__codelineno-7-21"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">p01</span><span class="p">);</span>
<a id="__codelineno-7-22" name="__codelineno-7-22"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">p02</span><span class="p">);</span>
<a id="__codelineno-7-23" name="__codelineno-7-23"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;club--------&quot;</span><span class="p">);</span>
<a id="__codelineno-7-24" name="__codelineno-7-24"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Personne</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">club</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-25" name="__codelineno-7-25"></a><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<a id="__codelineno-7-26" name="__codelineno-7-26"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-7-27" name="__codelineno-7-27"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;appartement--------&quot;</span><span class="p">);</span>
<a id="__codelineno-7-28" name="__codelineno-7-28"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">appart01</span><span class="p">);</span>
<a id="__codelineno-7-29" name="__codelineno-7-29"></a><span class="w">        </span><span class="c1">// les beans récupérés sont des singletons</span>
<a id="__codelineno-7-30" name="__codelineno-7-30"></a><span class="w">        </span><span class="c1">// on peut les demander plusieurs fois, on récupère toujours le même bean</span>
<a id="__codelineno-7-31" name="__codelineno-7-31"></a><span class="w">        </span><span class="n">Personne</span><span class="w"> </span><span class="n">p01b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="s">&quot;personne_01&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Personne</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<a id="__codelineno-7-32" name="__codelineno-7-32"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="s">&quot;beans [p01,p01b] identiques ? %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p01b</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">p01</span><span class="p">));</span>
<a id="__codelineno-7-33" name="__codelineno-7-33"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-7-34" name="__codelineno-7-34"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>la ligne 13 provoque l'instanciation de tous les beans définis dans la classe [Config] ;</li>
<li>le reste du code ne change pas ;</li>
</ul>
<h3 id="534-les-dependances-du-projet">5.3.4. Les dépendances du projet</h3>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000000D0000000DACB9D0C84.png" style="display:inline-block; margin:4px;width:3.851cm;height:4.039cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/1000000000000118000000FE63D89BAA.png" style="display:inline-block; margin:4px;width:5.181cm;height:4.701cm;" /></td></tr></table>

<p>Les dépendances sont fixées par le fichier [pom.xml] suivant :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-8-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-8-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-8-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-8-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-8-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-8-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-8-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-8-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-8-10">10</a></span>
<span class="normal"><a href="#__codelineno-8-11">11</a></span>
<span class="normal"><a href="#__codelineno-8-12">12</a></span>
<span class="normal"><a href="#__codelineno-8-13">13</a></span>
<span class="normal"><a href="#__codelineno-8-14">14</a></span>
<span class="normal"><a href="#__codelineno-8-15">15</a></span>
<span class="normal"><a href="#__codelineno-8-16">16</a></span>
<span class="normal"><a href="#__codelineno-8-17">17</a></span>
<span class="normal"><a href="#__codelineno-8-18">18</a></span>
<span class="normal"><a href="#__codelineno-8-19">19</a></span>
<span class="normal"><a href="#__codelineno-8-20">20</a></span>
<span class="normal"><a href="#__codelineno-8-21">21</a></span>
<span class="normal"><a href="#__codelineno-8-22">22</a></span>
<span class="normal"><a href="#__codelineno-8-23">23</a></span>
<span class="normal"><a href="#__codelineno-8-24">24</a></span>
<span class="normal"><a href="#__codelineno-8-25">25</a></span>
<span class="normal"><a href="#__codelineno-8-26">26</a></span>
<span class="normal"><a href="#__codelineno-8-27">27</a></span>
<span class="normal"><a href="#__codelineno-8-28">28</a></span>
<span class="normal"><a href="#__codelineno-8-29">29</a></span>
<span class="normal"><a href="#__codelineno-8-30">30</a></span>
<span class="normal"><a href="#__codelineno-8-31">31</a></span>
<span class="normal"><a href="#__codelineno-8-32">32</a></span>
<span class="normal"><a href="#__codelineno-8-33">33</a></span>
<span class="normal"><a href="#__codelineno-8-34">34</a></span>
<span class="normal"><a href="#__codelineno-8-35">35</a></span>
<span class="normal"><a href="#__codelineno-8-36">36</a></span>
<span class="normal"><a href="#__codelineno-8-37">37</a></span>
<span class="normal"><a href="#__codelineno-8-38">38</a></span>
<span class="normal"><a href="#__codelineno-8-39">39</a></span>
<span class="normal"><a href="#__codelineno-8-40">40</a></span>
<span class="normal"><a href="#__codelineno-8-41">41</a></span>
<span class="normal"><a href="#__codelineno-8-42">42</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a>&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
<a id="__codelineno-8-2" name="__codelineno-8-2"></a>    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
<a id="__codelineno-8-3" name="__codelineno-8-3"></a>    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
<a id="__codelineno-8-4" name="__codelineno-8-4"></a>    &lt;groupId&gt;istia.st.spring.core&lt;/groupId&gt;
<a id="__codelineno-8-5" name="__codelineno-8-5"></a>    &lt;artifactId&gt;spring-core-02&lt;/artifactId&gt;
<a id="__codelineno-8-6" name="__codelineno-8-6"></a>    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
<a id="__codelineno-8-7" name="__codelineno-8-7"></a>    &lt;name&gt;spring-core-02&lt;/name&gt;
<a id="__codelineno-8-8" name="__codelineno-8-8"></a>    &lt;description&gt;Introduction à Spring&lt;/description&gt;
<a id="__codelineno-8-9" name="__codelineno-8-9"></a>
<a id="__codelineno-8-10" name="__codelineno-8-10"></a>    &lt;properties&gt;
<a id="__codelineno-8-11" name="__codelineno-8-11"></a>        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
<a id="__codelineno-8-12" name="__codelineno-8-12"></a>        &lt;java.version&gt;1.7&lt;/java.version&gt;
<a id="__codelineno-8-13" name="__codelineno-8-13"></a>    &lt;/properties&gt;
<a id="__codelineno-8-14" name="__codelineno-8-14"></a>
<a id="__codelineno-8-15" name="__codelineno-8-15"></a>    &lt;dependencies&gt;
<a id="__codelineno-8-16" name="__codelineno-8-16"></a>        &lt;!-- Spring --&gt;
<a id="__codelineno-8-17" name="__codelineno-8-17"></a>        &lt;dependency&gt;
<a id="__codelineno-8-18" name="__codelineno-8-18"></a>            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
<a id="__codelineno-8-19" name="__codelineno-8-19"></a>            &lt;artifactId&gt;spring-context&lt;/artifactId&gt;
<a id="__codelineno-8-20" name="__codelineno-8-20"></a>            &lt;version&gt;4.1.3.RELEASE&lt;/version&gt;
<a id="__codelineno-8-21" name="__codelineno-8-21"></a>        &lt;/dependency&gt;
<a id="__codelineno-8-22" name="__codelineno-8-22"></a>    &lt;/dependencies&gt;
<a id="__codelineno-8-23" name="__codelineno-8-23"></a>    &lt;!-- plugins --&gt;
<a id="__codelineno-8-24" name="__codelineno-8-24"></a>    &lt;build&gt;
<a id="__codelineno-8-25" name="__codelineno-8-25"></a>        &lt;plugins&gt;
<a id="__codelineno-8-26" name="__codelineno-8-26"></a>            &lt;plugin&gt;
<a id="__codelineno-8-27" name="__codelineno-8-27"></a>                &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;
<a id="__codelineno-8-28" name="__codelineno-8-28"></a>                &lt;configuration&gt;
<a id="__codelineno-8-29" name="__codelineno-8-29"></a>                    &lt;descriptorRefs&gt;
<a id="__codelineno-8-30" name="__codelineno-8-30"></a>                        &lt;descriptorRef&gt;jar-with-dependencies&lt;/descriptorRef&gt;
<a id="__codelineno-8-31" name="__codelineno-8-31"></a>                    &lt;/descriptorRefs&gt;
<a id="__codelineno-8-32" name="__codelineno-8-32"></a>                &lt;/configuration&gt;
<a id="__codelineno-8-33" name="__codelineno-8-33"></a>            &lt;/plugin&gt;
<a id="__codelineno-8-34" name="__codelineno-8-34"></a>            &lt;plugin&gt;
<a id="__codelineno-8-35" name="__codelineno-8-35"></a>                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
<a id="__codelineno-8-36" name="__codelineno-8-36"></a>                &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
<a id="__codelineno-8-37" name="__codelineno-8-37"></a>                &lt;version&gt;2.18.1&lt;/version&gt;
<a id="__codelineno-8-38" name="__codelineno-8-38"></a>            &lt;/plugin&gt;
<a id="__codelineno-8-39" name="__codelineno-8-39"></a>        &lt;/plugins&gt;
<a id="__codelineno-8-40" name="__codelineno-8-40"></a>    &lt;/build&gt;
<a id="__codelineno-8-41" name="__codelineno-8-41"></a>
<a id="__codelineno-8-42" name="__codelineno-8-42"></a>&lt;/project&gt;
</code></pre></div></td></tr></table></div>
<p>La gestion à la main des dépendances d'un projet devient un casse-tête lorsqu'on utilise des bibliothèques Java dont on ne connaît pas les dépendances. Ainsi le framework [Hibernate] qui gère l'accès aux bases de données a des dizaines de dépendances. Le projet [Maven] résoud ce problème. On nomme la dépendance dont on a besoin. Celle-ci est cherchée automatiquement dans des dépôts Maven répartis sur le net. Si la dépendance demandée a elle-même des dépendances, alors celles-ci sont automatiquement téléchargées également. Ces dépendances téléchargées sont stockées dans un dépôt local au poste. Si une autre application a besoin plus tard de la même dépendance, celle-ci ne sera pas téléchargée mais cherchée dans le dépôt local. Une dépendance est caractérisée par les éléments suivants :</p>
<ul>
<li>ligne 17 : une balise &lt;dependency&gt; ;</li>
<li>ligne 18 : un attribut [groupId] qui identifie en général l'entreprise qui a créé la dépendance ;</li>
<li>ligne 19 : un attribut [artifactId] qui identifie la dépendance ;</li>
<li>ligne 20 :  un attribut [version] qui identifie la version désirée ;</li>
</ul>
<p>La génération du projet va elle-même produire un composant Maven défini par les lignes 4-8 :</p>
<ul>
<li>lignes 4-6 : les attributs [ groupId, artifactId,version] que nous venons de décrire ;</li>
<li>lignes 7-8 : sont des attributs facultatifs ;</li>
</ul>
<p>Nous allons revenir un peu plus loin sur le rôle des lignes 24-40. Pour transformer un projet Eclipse ordinaire en un projet Maven, il faut faire deux choses :</p>
<ul>
<li>créer le fichier [pom.xml] précédent ;</li>
<li>déclarer que le projet est désormais un projet Maven [1-4] :</li>
</ul>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/1000000000000630000005599C8903AB.png" style="display:inline-block; margin:4px;width:17.999cm;height:15.556cm;" /></td></tr></table>

<p>L'icône d'un projet <strong>M</strong>aven a un <strong>M</strong> [4]. Le <strong>S</strong> indique que le projet a des éléments <strong>S</strong>pring. Il est déconseillé de transformer (comme nous venons de le faire) un projet Eclipse en projet Maven car alors le projet n'a pas la structure attendue pour un projet Maven ce qui peut amener parfois des problèmes inattendus.</p>
<h3 id="535-generation-de-lartifact-maven-du-projet">5.3.5. Génération de l'artifact Maven du projet</h3>
<p>Nous appelons artifact Maven du projet, l'élément défini par les lignes 4-6 du fichier [pom.xml] :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span>
<span class="normal"><a href="#__codelineno-9-2">2</a></span>
<span class="normal"><a href="#__codelineno-9-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a>    &lt;groupId&gt;istia.st.spring.core&lt;/groupId&gt;
<a id="__codelineno-9-2" name="__codelineno-9-2"></a>    &lt;artifactId&gt;spring-core-02&lt;/artifactId&gt;
<a id="__codelineno-9-3" name="__codelineno-9-3"></a>&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
</code></pre></div></td></tr></table></div>
<p>Pour générer cet artifact, il faut que les lignes 3-7 suivantes soient présentes dans le fichier [pom.xml] :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span>
<span class="normal"><a href="#__codelineno-10-2">2</a></span>
<span class="normal"><a href="#__codelineno-10-3">3</a></span>
<span class="normal"><a href="#__codelineno-10-4">4</a></span>
<span class="normal"><a href="#__codelineno-10-5">5</a></span>
<span class="normal"><a href="#__codelineno-10-6">6</a></span>
<span class="normal"><a href="#__codelineno-10-7">7</a></span>
<span class="normal"><a href="#__codelineno-10-8">8</a></span>
<span class="normal"><a href="#__codelineno-10-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a>    &lt;build&gt;
<a id="__codelineno-10-2" name="__codelineno-10-2"></a>        &lt;plugins&gt;
<a id="__codelineno-10-3" name="__codelineno-10-3"></a>            &lt;plugin&gt;
<a id="__codelineno-10-4" name="__codelineno-10-4"></a>                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
<a id="__codelineno-10-5" name="__codelineno-10-5"></a>                &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
<a id="__codelineno-10-6" name="__codelineno-10-6"></a>                &lt;version&gt;2.18.1&lt;/version&gt;
<a id="__codelineno-10-7" name="__codelineno-10-7"></a>            &lt;/plugin&gt;
<a id="__codelineno-10-8" name="__codelineno-10-8"></a>        &lt;/plugins&gt;
<a id="__codelineno-10-9" name="__codelineno-10-9"></a>&lt;/build&gt;
</code></pre></div></td></tr></table></div>
<p>Elles définissent le plugin de Maven capable de générer l'artifact du projet. On procéde ensuite de la façon suivante :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/1000000000000459000004E5D819CBF0.png" style="display:inline-block; margin:4px;width:14.725cm;height:16.577cm;" /></td></tr></table>

<p>L'artifact ainsi généré va dans le dépôt Maven local. La localisation de celui-ci peut être trouvée dans la configuration d'Eclipse :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000024B00000200824CCAC4.png" style="display:inline-block; margin:4px;width:10.871cm;height:9.479cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr></table>

<p>Il est alors possible de vérifier la bonne installation de l'artifact Maven :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/1000000000000177000000AFA0C2E283.png" style="display:inline-block; margin:4px;width:6.939cm;height:3.24cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr></table>

<p>Désormais, un autre projet Maven local pourra utiliser cette archive.</p>
<h2 id="54-exemple-03">5.4. Exemple-03</h2>
<h3 id="541-le-projet-eclipse">5.4.1. Le projet Eclipse</h3>
<p>Nous créons cette fois un projet Maven [1-8] :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000003C60000018399ABACEE.png" style="display:inline-block; margin:4px;width:12.779cm;height:5.121cm;" /></td></tr></table>

<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/1000000000000420000001B012B07181.png" style="display:inline-block; margin:4px;width:13.97cm;height:5.715cm;" /></td></tr></table>

<ul>
<li>en [3b] : désignez un dossier vide où sera généré le projet ;</li>
</ul>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/1000000000000502000001E727D0DA44.png" style="display:inline-block; margin:4px;width:16.96cm;height:6.443cm;" /></td></tr></table>

<ul>
<li>en [4] : l'identifiant du groupe Maven auquel appartiendra le projet ;</li>
<li>en [5] : le nom de l'artifact Maven produit :</li>
<li>en [6] : sa version ;</li>
<li>en [7]: son mode de packaging (il existe également war, ear, apk, ...) ;</li>
<li>en [8] : le projet ainsi créé ;</li>
</ul>
<p>Un projet Maven a par défaut, une arborescence précise :</p>
<ul>
<li>[src / main / java] : les codes source du projet. Les produits compilés de ces sources iront dans le dossier [target/classes] du projet ;</li>
<li>[src / main / resources] : les ressources qui doivent être dans le Classpath du projet sans pour autant être des sources Java. Elles seront recopiées telles-quelles dans le dossier [target/classes] du projet ;</li>
<li>[src / test / java] : les codes source des tests du projet. Les produits compilés de ces sources iront dans le dossier [target/test-classes] du projet. Ces éléments ne sont pas intégrés dans l'archive Maven du projet ;</li>
<li>[src / test / resources] : les ressources qui doivent être dans le Classpath du projet pour les tests sans pour autant être des sources Java. Elles seront recopiées telles-quelles dans le dossier [target/test-classes] du projet ;</li>
</ul>
<p>Nous complétons le projet de la façon suivante :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000000F0000001354C1F466D.png" style="display:inline-block; margin:4px;width:4.45cm;height:5.72cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr></table>

<h3 id="542-la-configuration-maven">5.4.2. La configuration Maven</h3>
<p>Un fichier [pom.xml] est généré par défaut. Nous le transformons de la façon suivante :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-11-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-11-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-11-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-11-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-11-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-11-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-11-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-11-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-11-10">10</a></span>
<span class="normal"><a href="#__codelineno-11-11">11</a></span>
<span class="normal"><a href="#__codelineno-11-12">12</a></span>
<span class="normal"><a href="#__codelineno-11-13">13</a></span>
<span class="normal"><a href="#__codelineno-11-14">14</a></span>
<span class="normal"><a href="#__codelineno-11-15">15</a></span>
<span class="normal"><a href="#__codelineno-11-16">16</a></span>
<span class="normal"><a href="#__codelineno-11-17">17</a></span>
<span class="normal"><a href="#__codelineno-11-18">18</a></span>
<span class="normal"><a href="#__codelineno-11-19">19</a></span>
<span class="normal"><a href="#__codelineno-11-20">20</a></span>
<span class="normal"><a href="#__codelineno-11-21">21</a></span>
<span class="normal"><a href="#__codelineno-11-22">22</a></span>
<span class="normal"><a href="#__codelineno-11-23">23</a></span>
<span class="normal"><a href="#__codelineno-11-24">24</a></span>
<span class="normal"><a href="#__codelineno-11-25">25</a></span>
<span class="normal"><a href="#__codelineno-11-26">26</a></span>
<span class="normal"><a href="#__codelineno-11-27">27</a></span>
<span class="normal"><a href="#__codelineno-11-28">28</a></span>
<span class="normal"><a href="#__codelineno-11-29">29</a></span>
<span class="normal"><a href="#__codelineno-11-30">30</a></span>
<span class="normal"><a href="#__codelineno-11-31">31</a></span>
<span class="normal"><a href="#__codelineno-11-32">32</a></span>
<span class="normal"><a href="#__codelineno-11-33">33</a></span>
<span class="normal"><a href="#__codelineno-11-34">34</a></span>
<span class="normal"><a href="#__codelineno-11-35">35</a></span>
<span class="normal"><a href="#__codelineno-11-36">36</a></span>
<span class="normal"><a href="#__codelineno-11-37">37</a></span>
<span class="normal"><a href="#__codelineno-11-38">38</a></span>
<span class="normal"><a href="#__codelineno-11-39">39</a></span>
<span class="normal"><a href="#__codelineno-11-40">40</a></span>
<span class="normal"><a href="#__codelineno-11-41">41</a></span>
<span class="normal"><a href="#__codelineno-11-42">42</a></span>
<span class="normal"><a href="#__codelineno-11-43">43</a></span>
<span class="normal"><a href="#__codelineno-11-44">44</a></span>
<span class="normal"><a href="#__codelineno-11-45">45</a></span>
<span class="normal"><a href="#__codelineno-11-46">46</a></span>
<span class="normal"><a href="#__codelineno-11-47">47</a></span>
<span class="normal"><a href="#__codelineno-11-48">48</a></span>
<span class="normal"><a href="#__codelineno-11-49">49</a></span>
<span class="normal"><a href="#__codelineno-11-50">50</a></span>
<span class="normal"><a href="#__codelineno-11-51">51</a></span>
<span class="normal"><a href="#__codelineno-11-52">52</a></span>
<span class="normal"><a href="#__codelineno-11-53">53</a></span>
<span class="normal"><a href="#__codelineno-11-54">54</a></span>
<span class="normal"><a href="#__codelineno-11-55">55</a></span>
<span class="normal"><a href="#__codelineno-11-56">56</a></span>
<span class="normal"><a href="#__codelineno-11-57">57</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a>&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
<a id="__codelineno-11-2" name="__codelineno-11-2"></a>    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
<a id="__codelineno-11-3" name="__codelineno-11-3"></a>    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
<a id="__codelineno-11-4" name="__codelineno-11-4"></a>    &lt;groupId&gt;istia.st.spring.core&lt;/groupId&gt;
<a id="__codelineno-11-5" name="__codelineno-11-5"></a>    &lt;artifactId&gt;spring-core-03&lt;/artifactId&gt;
<a id="__codelineno-11-6" name="__codelineno-11-6"></a>    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
<a id="__codelineno-11-7" name="__codelineno-11-7"></a>    &lt;name&gt;spring-core-03&lt;/name&gt;
<a id="__codelineno-11-8" name="__codelineno-11-8"></a>    &lt;description&gt;Introduction à Spring&lt;/description&gt;
<a id="__codelineno-11-9" name="__codelineno-11-9"></a>
<a id="__codelineno-11-10" name="__codelineno-11-10"></a>    &lt;properties&gt;
<a id="__codelineno-11-11" name="__codelineno-11-11"></a>        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
<a id="__codelineno-11-12" name="__codelineno-11-12"></a>        &lt;java.version&gt;1.8&lt;/java.version&gt;
<a id="__codelineno-11-13" name="__codelineno-11-13"></a>    &lt;/properties&gt;
<a id="__codelineno-11-14" name="__codelineno-11-14"></a>
<a id="__codelineno-11-15" name="__codelineno-11-15"></a>    &lt;!-- projet Maven parent --&gt;
<a id="__codelineno-11-16" name="__codelineno-11-16"></a>    &lt;parent&gt;
<a id="__codelineno-11-17" name="__codelineno-11-17"></a>        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
<a id="__codelineno-11-18" name="__codelineno-11-18"></a>        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
<a id="__codelineno-11-19" name="__codelineno-11-19"></a>        &lt;version&gt;1.2.3.RELEASE&lt;/version&gt;
<a id="__codelineno-11-20" name="__codelineno-11-20"></a>    &lt;/parent&gt;
<a id="__codelineno-11-21" name="__codelineno-11-21"></a>
<a id="__codelineno-11-22" name="__codelineno-11-22"></a>    &lt;dependencies&gt;
<a id="__codelineno-11-23" name="__codelineno-11-23"></a>        &lt;!-- Spring Context --&gt;
<a id="__codelineno-11-24" name="__codelineno-11-24"></a>        &lt;dependency&gt;
<a id="__codelineno-11-25" name="__codelineno-11-25"></a>            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
<a id="__codelineno-11-26" name="__codelineno-11-26"></a>            &lt;artifactId&gt;spring-context&lt;/artifactId&gt;
<a id="__codelineno-11-27" name="__codelineno-11-27"></a>        &lt;/dependency&gt;
<a id="__codelineno-11-28" name="__codelineno-11-28"></a>        &lt;!-- logs --&gt;
<a id="__codelineno-11-29" name="__codelineno-11-29"></a>        &lt;dependency&gt;
<a id="__codelineno-11-30" name="__codelineno-11-30"></a>            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
<a id="__codelineno-11-31" name="__codelineno-11-31"></a>            &lt;artifactId&gt;spring-boot-starter-logging&lt;/artifactId&gt;
<a id="__codelineno-11-32" name="__codelineno-11-32"></a>        &lt;/dependency&gt;
<a id="__codelineno-11-33" name="__codelineno-11-33"></a>
<a id="__codelineno-11-34" name="__codelineno-11-34"></a>    &lt;/dependencies&gt;
<a id="__codelineno-11-35" name="__codelineno-11-35"></a>
<a id="__codelineno-11-36" name="__codelineno-11-36"></a>    &lt;!-- plugins --&gt;
<a id="__codelineno-11-37" name="__codelineno-11-37"></a>    &lt;build&gt;
<a id="__codelineno-11-38" name="__codelineno-11-38"></a>        &lt;plugins&gt;
<a id="__codelineno-11-39" name="__codelineno-11-39"></a>            &lt;!-- pour la génération de l&#39;archive du projet avec ses dépendances --&gt;
<a id="__codelineno-11-40" name="__codelineno-11-40"></a>            &lt;plugin&gt;
<a id="__codelineno-11-41" name="__codelineno-11-41"></a>                &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;
<a id="__codelineno-11-42" name="__codelineno-11-42"></a>                &lt;configuration&gt;
<a id="__codelineno-11-43" name="__codelineno-11-43"></a>                    &lt;descriptorRefs&gt;
<a id="__codelineno-11-44" name="__codelineno-11-44"></a>                        &lt;descriptorRef&gt;jar-with-dependencies&lt;/descriptorRef&gt;
<a id="__codelineno-11-45" name="__codelineno-11-45"></a>                    &lt;/descriptorRefs&gt;
<a id="__codelineno-11-46" name="__codelineno-11-46"></a>                &lt;/configuration&gt;
<a id="__codelineno-11-47" name="__codelineno-11-47"></a>            &lt;/plugin&gt;
<a id="__codelineno-11-48" name="__codelineno-11-48"></a>            &lt;!-- pour l&#39;installation de l&#39;artifact du projet dans le dépôt local Maven --&gt;
<a id="__codelineno-11-49" name="__codelineno-11-49"></a>            &lt;plugin&gt;
<a id="__codelineno-11-50" name="__codelineno-11-50"></a>                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
<a id="__codelineno-11-51" name="__codelineno-11-51"></a>                &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
<a id="__codelineno-11-52" name="__codelineno-11-52"></a>                &lt;version&gt;2.18.1&lt;/version&gt;
<a id="__codelineno-11-53" name="__codelineno-11-53"></a>            &lt;/plugin&gt;
<a id="__codelineno-11-54" name="__codelineno-11-54"></a>        &lt;/plugins&gt;
<a id="__codelineno-11-55" name="__codelineno-11-55"></a>    &lt;/build&gt;
<a id="__codelineno-11-56" name="__codelineno-11-56"></a>
<a id="__codelineno-11-57" name="__codelineno-11-57"></a>&lt;/project&gt;
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 11 : le projet est codé en UTF-8 ;</li>
<li>ligne 12 : on utilise un JDK 1.8 pour compiler le projet ;</li>
<li>lignes 16-20 : pour les projets utilisant les bibliothèques Spring, il est pratique d'utiliser un projet Maven parent appelé [spring-boot-starter-parent]. Celui-ci définit les versions de différentes bibliothèques Spring ainsi que celles de leurs dépendances. Ceci permet de ne plus les définir dans la définition des dépendances. Ainsi lignes 24-27 on ne précise pas la version de [spring-context] désirée. Ce sera celle définie par le projet parent [spring-boot-starter-parent]. Cette technique permet de ne pas se soucier d'éventuelles incompatibilités de versions entre dépendances. Celles définies  par le projet parent sont compatibles entre-elles ;</li>
<li>lignes 29-32 : Spring écrit un nombre important d'informations sur la console au travers d'une bibliothèque de logs. Celle-ci est importée ici ;</li>
<li>lignes 40-47 : un plugin Maven sur lequel nous allons revenir ;</li>
<li>lignes 50-52 : le plugin de génération de l'artifact Maven du projet ;</li>
</ul>
<h3 id="543-la-classe-de-configuration-de-spring">5.4.3. La classe de configuration de Spring</h3>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000000C7000000912C7701B6.png" style="display:inline-block; margin:4px;width:3.679cm;height:2.679cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr></table>

<p>La classe [Config] est la suivante :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-12-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-12-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-12-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-12-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-12-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-12-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-12-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-12-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-12-10">10</a></span>
<span class="normal"><a href="#__codelineno-12-11">11</a></span>
<span class="normal"><a href="#__codelineno-12-12">12</a></span>
<span class="normal"><a href="#__codelineno-12-13">13</a></span>
<span class="normal"><a href="#__codelineno-12-14">14</a></span>
<span class="normal"><a href="#__codelineno-12-15">15</a></span>
<span class="normal"><a href="#__codelineno-12-16">16</a></span>
<span class="normal"><a href="#__codelineno-12-17">17</a></span>
<span class="normal"><a href="#__codelineno-12-18">18</a></span>
<span class="normal"><a href="#__codelineno-12-19">19</a></span>
<span class="normal"><a href="#__codelineno-12-20">20</a></span>
<span class="normal"><a href="#__codelineno-12-21">21</a></span>
<span class="normal"><a href="#__codelineno-12-22">22</a></span>
<span class="normal"><a href="#__codelineno-12-23">23</a></span>
<span class="normal"><a href="#__codelineno-12-24">24</a></span>
<span class="normal"><a href="#__codelineno-12-25">25</a></span>
<span class="normal"><a href="#__codelineno-12-26">26</a></span>
<span class="normal"><a href="#__codelineno-12-27">27</a></span>
<span class="normal"><a href="#__codelineno-12-28">28</a></span>
<span class="normal"><a href="#__codelineno-12-29">29</a></span>
<span class="normal"><a href="#__codelineno-12-30">30</a></span>
<span class="normal"><a href="#__codelineno-12-31">31</a></span>
<span class="normal"><a href="#__codelineno-12-32">32</a></span>
<span class="normal"><a href="#__codelineno-12-33">33</a></span>
<span class="normal"><a href="#__codelineno-12-34">34</a></span>
<span class="normal"><a href="#__codelineno-12-35">35</a></span>
<span class="normal"><a href="#__codelineno-12-36">36</a></span>
<span class="normal"><a href="#__codelineno-12-37">37</a></span>
<span class="normal"><a href="#__codelineno-12-38">38</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">istia.st.spring.core.config</span><span class="p">;</span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">istia.st.spring.core.entities.Personne</span><span class="p">;</span>
<a id="__codelineno-12-4" name="__codelineno-12-4"></a>
<a id="__codelineno-12-5" name="__codelineno-12-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.ArrayList</span><span class="p">;</span>
<a id="__codelineno-12-6" name="__codelineno-12-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>
<a id="__codelineno-12-7" name="__codelineno-12-7"></a>
<a id="__codelineno-12-8" name="__codelineno-12-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Bean</span><span class="p">;</span>
<a id="__codelineno-12-9" name="__codelineno-12-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.ComponentScan</span><span class="p">;</span>
<a id="__codelineno-12-10" name="__codelineno-12-10"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Configuration</span><span class="p">;</span>
<a id="__codelineno-12-11" name="__codelineno-12-11"></a>
<a id="__codelineno-12-12" name="__codelineno-12-12"></a><span class="nd">@Configuration</span>
<a id="__codelineno-12-13" name="__codelineno-12-13"></a><span class="nd">@ComponentScan</span><span class="p">({</span><span class="w"> </span><span class="s">&quot;spring.core.entities&quot;</span><span class="w"> </span><span class="p">})</span>
<a id="__codelineno-12-14" name="__codelineno-12-14"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Config</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-15" name="__codelineno-12-15"></a>
<a id="__codelineno-12-16" name="__codelineno-12-16"></a><span class="w">    </span><span class="nd">@Bean</span>
<a id="__codelineno-12-17" name="__codelineno-12-17"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Personne</span><span class="w"> </span><span class="nf">personne_01</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-18" name="__codelineno-12-18"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Personne</span><span class="p">(</span><span class="s">&quot;Paul&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Dubois&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">34</span><span class="p">);</span>
<a id="__codelineno-12-19" name="__codelineno-12-19"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-12-20" name="__codelineno-12-20"></a>
<a id="__codelineno-12-21" name="__codelineno-12-21"></a><span class="w">    </span><span class="nd">@Bean</span>
<a id="__codelineno-12-22" name="__codelineno-12-22"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Personne</span><span class="w"> </span><span class="nf">personne_02</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-23" name="__codelineno-12-23"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Personne</span><span class="p">(</span><span class="s">&quot;Martin&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Micheline&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">18</span><span class="p">);</span>
<a id="__codelineno-12-24" name="__codelineno-12-24"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-12-25" name="__codelineno-12-25"></a>
<a id="__codelineno-12-26" name="__codelineno-12-26"></a><span class="w">    </span><span class="nd">@Bean</span>
<a id="__codelineno-12-27" name="__codelineno-12-27"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Personne</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">club</span><span class="p">(</span><span class="n">Personne</span><span class="w"> </span><span class="n">personne_01</span><span class="p">,</span><span class="w"> </span><span class="n">Personne</span><span class="w"> </span><span class="n">personne_02</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-28" name="__codelineno-12-28"></a><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Personne</span><span class="o">&gt;</span><span class="w"> </span><span class="n">personnes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Personne</span><span class="o">&gt;</span><span class="p">();</span>
<a id="__codelineno-12-29" name="__codelineno-12-29"></a><span class="w">        </span><span class="n">personnes</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">personne_01</span><span class="p">);</span>
<a id="__codelineno-12-30" name="__codelineno-12-30"></a><span class="w">        </span><span class="n">personnes</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">personne_02</span><span class="p">);</span>
<a id="__codelineno-12-31" name="__codelineno-12-31"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">personnes</span><span class="p">;</span>
<a id="__codelineno-12-32" name="__codelineno-12-32"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-12-33" name="__codelineno-12-33"></a>
<a id="__codelineno-12-34" name="__codelineno-12-34"></a><span class="w">    </span><span class="nd">@Bean</span>
<a id="__codelineno-12-35" name="__codelineno-12-35"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">mySurface</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-36" name="__codelineno-12-36"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">200</span><span class="p">;</span>
<a id="__codelineno-12-37" name="__codelineno-12-37"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-12-38" name="__codelineno-12-38"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>on retrouve là un code déjà commenté avec deux nouveautés :</li>
<li>ligne 13 : indique qu'il y a d'autres beans à instancier dans le package [spring.core.entities],</li>
<li>lignes 34-37 : un bean [mySurface] ;</li>
</ul>
<h3 id="544-la-classe-appartement">5.4.4. La classe [Appartement]</h3>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000000CB0000009067F100C7.png" style="display:inline-block; margin:4px;width:3.761cm;height:2.671cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr></table>

<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-13-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-13-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-13-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-13-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-13-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-13-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-13-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-13-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-13-10">10</a></span>
<span class="normal"><a href="#__codelineno-13-11">11</a></span>
<span class="normal"><a href="#__codelineno-13-12">12</a></span>
<span class="normal"><a href="#__codelineno-13-13">13</a></span>
<span class="normal"><a href="#__codelineno-13-14">14</a></span>
<span class="normal"><a href="#__codelineno-13-15">15</a></span>
<span class="normal"><a href="#__codelineno-13-16">16</a></span>
<span class="normal"><a href="#__codelineno-13-17">17</a></span>
<span class="normal"><a href="#__codelineno-13-18">18</a></span>
<span class="normal"><a href="#__codelineno-13-19">19</a></span>
<span class="normal"><a href="#__codelineno-13-20">20</a></span>
<span class="normal"><a href="#__codelineno-13-21">21</a></span>
<span class="normal"><a href="#__codelineno-13-22">22</a></span>
<span class="normal"><a href="#__codelineno-13-23">23</a></span>
<span class="normal"><a href="#__codelineno-13-24">24</a></span>
<span class="normal"><a href="#__codelineno-13-25">25</a></span>
<span class="normal"><a href="#__codelineno-13-26">26</a></span>
<span class="normal"><a href="#__codelineno-13-27">27</a></span>
<span class="normal"><a href="#__codelineno-13-28">28</a></span>
<span class="normal"><a href="#__codelineno-13-29">29</a></span>
<span class="normal"><a href="#__codelineno-13-30">30</a></span>
<span class="normal"><a href="#__codelineno-13-31">31</a></span>
<span class="normal"><a href="#__codelineno-13-32">32</a></span>
<span class="normal"><a href="#__codelineno-13-33">33</a></span>
<span class="normal"><a href="#__codelineno-13-34">34</a></span>
<span class="normal"><a href="#__codelineno-13-35">35</a></span>
<span class="normal"><a href="#__codelineno-13-36">36</a></span>
<span class="normal"><a href="#__codelineno-13-37">37</a></span>
<span class="normal"><a href="#__codelineno-13-38">38</a></span>
<span class="normal"><a href="#__codelineno-13-39">39</a></span>
<span class="normal"><a href="#__codelineno-13-40">40</a></span>
<span class="normal"><a href="#__codelineno-13-41">41</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="n">package</span> <span class="n">spring</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">entities</span><span class="p">;</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>
<a id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.beans.factory.annotation.Qualifier</span><span class="p">;</span>
<a id="__codelineno-13-5" name="__codelineno-13-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.stereotype.Component</span><span class="p">;</span>
<a id="__codelineno-13-6" name="__codelineno-13-6"></a>
<a id="__codelineno-13-7" name="__codelineno-13-7"></a><span class="nd">@Component</span>
<a id="__codelineno-13-8" name="__codelineno-13-8"></a><span class="n">public</span> <span class="k">class</span><span class="w"> </span><span class="nc">Appartement</span> <span class="p">{</span>
<a id="__codelineno-13-9" name="__codelineno-13-9"></a>
<a id="__codelineno-13-10" name="__codelineno-13-10"></a>    <span class="o">//</span> <span class="n">champs</span> <span class="n">injectés</span> <span class="n">par</span> <span class="n">Spring</span>
<a id="__codelineno-13-11" name="__codelineno-13-11"></a>    <span class="nd">@Autowired</span>
<a id="__codelineno-13-12" name="__codelineno-13-12"></a>    <span class="nd">@Qualifier</span><span class="p">(</span><span class="s2">&quot;personne_01&quot;</span><span class="p">)</span>
<a id="__codelineno-13-13" name="__codelineno-13-13"></a>    <span class="n">private</span> <span class="n">Personne</span> <span class="n">propriétaire</span><span class="p">;</span>
<a id="__codelineno-13-14" name="__codelineno-13-14"></a>
<a id="__codelineno-13-15" name="__codelineno-13-15"></a>    <span class="nd">@Autowired</span>
<a id="__codelineno-13-16" name="__codelineno-13-16"></a>    <span class="nd">@Qualifier</span><span class="p">(</span><span class="s2">&quot;mySurface&quot;</span><span class="p">)</span>
<a id="__codelineno-13-17" name="__codelineno-13-17"></a>    <span class="n">private</span> <span class="nb">int</span> <span class="n">surface</span><span class="p">;</span>
<a id="__codelineno-13-18" name="__codelineno-13-18"></a>
<a id="__codelineno-13-19" name="__codelineno-13-19"></a>    <span class="o">//</span> <span class="n">getters</span> <span class="n">et</span> <span class="n">setters</span>
<a id="__codelineno-13-20" name="__codelineno-13-20"></a>    <span class="n">public</span> <span class="n">Personne</span> <span class="n">getPropriétaire</span><span class="p">()</span> <span class="p">{</span>
<a id="__codelineno-13-21" name="__codelineno-13-21"></a>        <span class="k">return</span> <span class="n">propriétaire</span><span class="p">;</span>
<a id="__codelineno-13-22" name="__codelineno-13-22"></a>    <span class="p">}</span>
<a id="__codelineno-13-23" name="__codelineno-13-23"></a>
<a id="__codelineno-13-24" name="__codelineno-13-24"></a>    <span class="n">public</span> <span class="n">void</span> <span class="n">setPropriétaire</span><span class="p">(</span><span class="n">Personne</span> <span class="n">propriétaire</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-13-25" name="__codelineno-13-25"></a>        <span class="n">this</span><span class="o">.</span><span class="n">propriétaire</span> <span class="o">=</span> <span class="n">propriétaire</span><span class="p">;</span>
<a id="__codelineno-13-26" name="__codelineno-13-26"></a>    <span class="p">}</span>
<a id="__codelineno-13-27" name="__codelineno-13-27"></a>
<a id="__codelineno-13-28" name="__codelineno-13-28"></a>    <span class="n">public</span> <span class="nb">int</span> <span class="n">getSurface</span><span class="p">()</span> <span class="p">{</span>
<a id="__codelineno-13-29" name="__codelineno-13-29"></a>        <span class="k">return</span> <span class="n">surface</span><span class="p">;</span>
<a id="__codelineno-13-30" name="__codelineno-13-30"></a>    <span class="p">}</span>
<a id="__codelineno-13-31" name="__codelineno-13-31"></a>
<a id="__codelineno-13-32" name="__codelineno-13-32"></a>    <span class="n">public</span> <span class="n">void</span> <span class="n">setSurface</span><span class="p">(</span><span class="nb">int</span> <span class="n">surface</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-13-33" name="__codelineno-13-33"></a>        <span class="n">this</span><span class="o">.</span><span class="n">surface</span> <span class="o">=</span> <span class="n">surface</span><span class="p">;</span>
<a id="__codelineno-13-34" name="__codelineno-13-34"></a>    <span class="p">}</span>
<a id="__codelineno-13-35" name="__codelineno-13-35"></a>
<a id="__codelineno-13-36" name="__codelineno-13-36"></a>    <span class="o">//</span> <span class="n">toString</span>
<a id="__codelineno-13-37" name="__codelineno-13-37"></a>    <span class="n">public</span> <span class="n">String</span> <span class="n">toString</span><span class="p">()</span> <span class="p">{</span>
<a id="__codelineno-13-38" name="__codelineno-13-38"></a>        <span class="k">return</span> <span class="n">String</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;Appartement[</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">]&quot;</span><span class="p">,</span> <span class="n">propriétaire</span><span class="p">,</span> <span class="n">surface</span><span class="p">);</span>
<a id="__codelineno-13-39" name="__codelineno-13-39"></a>    <span class="p">}</span>
<a id="__codelineno-13-40" name="__codelineno-13-40"></a>
<a id="__codelineno-13-41" name="__codelineno-13-41"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 7 : l'annotation [@Component] indique à Spring que la classe est un singleton que le framework doit instancier et gérer. C'est parce que dans la classe [Config], nous avons écrit [@ComponentScan({ "istia.st.spring.core.entities" })] que ce singleton va être trouvé ;</li>
<li>ligne 11 : demande à Spring d'injecter dans le champ la référence d'un des singletons. Celui-ci peut être défini de deux façons :</li>
<li>par son identifiant (lignes 12, 16),</li>
<li>par son type s'il n'y a qu'un singleton ayant ce type ;</li>
</ul>
<h3 id="545-execution-du-projet">5.4.5. Exécution du projet</h3>
<p>L'exécution du projet donne le résultat suivant dans la console :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-14-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-14-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-14-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-14-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-14-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-14-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-14-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-14-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-14-10">10</a></span>
<span class="normal"><a href="#__codelineno-14-11">11</a></span>
<span class="normal"><a href="#__codelineno-14-12">12</a></span>
<span class="normal"><a href="#__codelineno-14-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="mf">17</span><span class="o">:</span><span class="mf">32</span><span class="o">:</span><span class="mf">39.797</span><span class="w"> </span><span class="p">[</span><span class="nx">main</span><span class="p">]</span><span class="w"> </span><span class="nx">DEBUG</span><span class="w"> </span><span class="nx">o</span><span class="p">.</span><span class="nx">s</span><span class="p">.</span><span class="nx">core</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">StandardEnvironment</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Adding</span><span class="w"> </span><span class="p">[</span><span class="nx">systemProperties</span><span class="p">]</span><span class="w"> </span><span class="nx">PropertySource</span><span class="w"> </span><span class="kd">with</span><span class="w"> </span><span class="nx">lowest</span><span class="w"> </span><span class="nx">search</span><span class="w"> </span><span class="nx">precedence</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="p">....</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="mf">17</span><span class="o">:</span><span class="mf">32</span><span class="o">:</span><span class="mf">40.134</span><span class="w"> </span><span class="p">[</span><span class="nx">main</span><span class="p">]</span><span class="w"> </span><span class="nx">DEBUG</span><span class="w"> </span><span class="nx">o</span><span class="p">.</span><span class="nx">s</span><span class="p">.</span><span class="nx">b</span><span class="p">.</span><span class="nx">f</span><span class="p">.</span><span class="nx">s</span><span class="p">.</span><span class="nx">DefaultListableBeanFactory</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Returning</span><span class="w"> </span><span class="nx">cached</span><span class="w"> </span><span class="nx">instance</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">singleton</span><span class="w"> </span><span class="nx">bean</span><span class="w"> </span><span class="s1">&#39;appartement&#39;</span>
<a id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="nx">personnes</span><span class="o">--------</span>
<a id="__codelineno-14-5" name="__codelineno-14-5"></a><span class="nx">Personne</span><span class="p">[</span><span class="nx">Dubois</span><span class="p">,</span><span class="w"> </span><span class="nx">Paul</span><span class="p">,</span><span class="mf">34</span><span class="p">]</span>
<a id="__codelineno-14-6" name="__codelineno-14-6"></a><span class="nx">Personne</span><span class="p">[</span><span class="nx">Micheline</span><span class="p">,</span><span class="w"> </span><span class="nx">Martin</span><span class="p">,</span><span class="mf">18</span><span class="p">]</span>
<a id="__codelineno-14-7" name="__codelineno-14-7"></a><span class="nx">club</span><span class="o">--------</span>
<a id="__codelineno-14-8" name="__codelineno-14-8"></a><span class="nx">Personne</span><span class="p">[</span><span class="nx">Dubois</span><span class="p">,</span><span class="w"> </span><span class="nx">Paul</span><span class="p">,</span><span class="mf">34</span><span class="p">]</span>
<a id="__codelineno-14-9" name="__codelineno-14-9"></a><span class="nx">Personne</span><span class="p">[</span><span class="nx">Micheline</span><span class="p">,</span><span class="w"> </span><span class="nx">Martin</span><span class="p">,</span><span class="mf">18</span><span class="p">]</span>
<a id="__codelineno-14-10" name="__codelineno-14-10"></a><span class="nx">appartement</span><span class="o">--------</span>
<a id="__codelineno-14-11" name="__codelineno-14-11"></a><span class="nx">Appartement</span><span class="p">[</span><span class="nx">Personne</span><span class="p">[</span><span class="nx">Dubois</span><span class="p">,</span><span class="w"> </span><span class="nx">Paul</span><span class="p">,</span><span class="mf">34</span><span class="p">],</span><span class="w"> </span><span class="mf">200</span><span class="p">]</span>
<a id="__codelineno-14-12" name="__codelineno-14-12"></a><span class="mf">17</span><span class="o">:</span><span class="mf">32</span><span class="o">:</span><span class="mf">40.135</span><span class="w"> </span><span class="p">[</span><span class="nx">main</span><span class="p">]</span><span class="w"> </span><span class="nx">DEBUG</span><span class="w"> </span><span class="nx">o</span><span class="p">.</span><span class="nx">s</span><span class="p">.</span><span class="nx">b</span><span class="p">.</span><span class="nx">f</span><span class="p">.</span><span class="nx">s</span><span class="p">.</span><span class="nx">DefaultListableBeanFactory</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">Returning</span><span class="w"> </span><span class="nx">cached</span><span class="w"> </span><span class="nx">instance</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">singleton</span><span class="w"> </span><span class="nx">bean</span><span class="w"> </span><span class="s1">&#39;personne_01&#39;</span>
<a id="__codelineno-14-13" name="__codelineno-14-13"></a><span class="nx">beans</span><span class="w"> </span><span class="p">[</span><span class="nx">p01</span><span class="p">,</span><span class="nx">p01b</span><span class="p">]</span><span class="w"> </span><span class="nx">identiques</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="kc">true</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>lignes 1-3 : Spring génère un très grand nombre de logs, plusieurs dizaines de lignes. Ces logs peuvent être très utiles pour déboguer un projet qui ne marche pas. Lorsqu'il fonctionne, on peut réduire les logs de la façon suivante :</li>
</ul>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000000EE000000C927997B07.png" style="display:inline-block; margin:4px;width:4.41cm;height:3.72cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr></table>

<p>Dans le dossier [src / main / resources] on crée le fichier [logback.xml] suivant :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-15-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-15-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-15-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-15-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-15-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-15-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-15-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-15-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-15-10">10</a></span>
<span class="normal"><a href="#__codelineno-15-11">11</a></span>
<span class="normal"><a href="#__codelineno-15-12">12</a></span>
<span class="normal"><a href="#__codelineno-15-13">13</a></span>
<span class="normal"><a href="#__codelineno-15-14">14</a></span>
<span class="normal"><a href="#__codelineno-15-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a>&lt;configuration&gt; 
<a id="__codelineno-15-2" name="__codelineno-15-2"></a>
<a id="__codelineno-15-3" name="__codelineno-15-3"></a>  &lt;appender name=&quot;STDOUT&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt; 
<a id="__codelineno-15-4" name="__codelineno-15-4"></a>    &lt;!-- encoders are  by default assigned the type
<a id="__codelineno-15-5" name="__codelineno-15-5"></a>         ch.qos.logback.classic.encoder.PatternLayoutEncoder --&gt;
<a id="__codelineno-15-6" name="__codelineno-15-6"></a>    &lt;encoder&gt;
<a id="__codelineno-15-7" name="__codelineno-15-7"></a>      &lt;pattern&gt;%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n&lt;/pattern&gt;
<a id="__codelineno-15-8" name="__codelineno-15-8"></a>    &lt;/encoder&gt;
<a id="__codelineno-15-9" name="__codelineno-15-9"></a>  &lt;/appender&gt;
<a id="__codelineno-15-10" name="__codelineno-15-10"></a>
<a id="__codelineno-15-11" name="__codelineno-15-11"></a>  &lt;!-- contrôle niveau des logs --&gt;
<a id="__codelineno-15-12" name="__codelineno-15-12"></a>  &lt;root level=&quot;info&quot;&gt; &lt;!-- info, debug, warn --&gt;
<a id="__codelineno-15-13" name="__codelineno-15-13"></a>    &lt;appender-ref ref=&quot;STDOUT&quot; /&gt;
<a id="__codelineno-15-14" name="__codelineno-15-14"></a>  &lt;/root&gt;
<a id="__codelineno-15-15" name="__codelineno-15-15"></a>&lt;/configuration&gt;
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 12, on fixe le niveau des logs. [debug] est un niveau très détaillé, [info] beaucoup moins ;</li>
</ul>
<p>Voici les résultats avec [level=info] :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-16-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-16-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-16-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-16-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-16-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-16-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-16-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-16-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-16-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a>17:39:58.580 [main] INFO  o.s.c.a.AnnotationConfigApplicationContext - Refreshing org.springframework.context.annotation.AnnotationConfigApplicationContext@7cf10a6f: startup date [Tue Apr 07 17:39:58 CEST 2015]; root of context hierarchy
<a id="__codelineno-16-2" name="__codelineno-16-2"></a>personnes--------
<a id="__codelineno-16-3" name="__codelineno-16-3"></a>Personne[Dubois, Paul,34]
<a id="__codelineno-16-4" name="__codelineno-16-4"></a>Personne[Micheline, Martin,18]
<a id="__codelineno-16-5" name="__codelineno-16-5"></a>club--------
<a id="__codelineno-16-6" name="__codelineno-16-6"></a>Personne[Dubois, Paul,34]
<a id="__codelineno-16-7" name="__codelineno-16-7"></a>Personne[Micheline, Martin,18]
<a id="__codelineno-16-8" name="__codelineno-16-8"></a>appartement--------
<a id="__codelineno-16-9" name="__codelineno-16-9"></a>Appartement[Personne[Dubois, Paul,34], 200]
<a id="__codelineno-16-10" name="__codelineno-16-10"></a>beans [p01,p01b] identiques ? true
</code></pre></div></td></tr></table></div>
<p>Il n'y a plus qu'une ligne de logs.</p>
<h3 id="546-generation-de-larchive-du-projet-avec-ses-dependances">5.4.6. Génération de l'archive du projet avec ses dépendances</h3>
<p>L'archive créée dans le projet précédent peut être également utilisée par un projet Eclipse non Maven. Certains projets utilisent de nombreuses bibliothèques et il peut être délicat de ne pas en oublier. C'est là que Maven fait merveille car il suffit de nommer la dépendance de niveau le plus haut pour que les autres de niveau plus bas soient automatiquement ajoutées au Classpath du projet.  Lorsque qu'un projet Eclipse non Maven doit utiliser les archives d'un projet Maven, il est possible de générer l'artifact de ce dernier avec toutes ses dépendances (ce qui n'était pas le cas dans le projet précédent). Pour cette génération, il faut que les lignes 3-10 suivantes soient présentes dans le fichier [pom.xml] :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-17-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-17-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-17-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-17-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-17-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-17-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-17-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-17-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-17-10">10</a></span>
<span class="normal"><a href="#__codelineno-17-11">11</a></span>
<span class="normal"><a href="#__codelineno-17-12">12</a></span>
<span class="normal"><a href="#__codelineno-17-13">13</a></span>
<span class="normal"><a href="#__codelineno-17-14">14</a></span>
<span class="normal"><a href="#__codelineno-17-15">15</a></span>
<span class="normal"><a href="#__codelineno-17-16">16</a></span>
<span class="normal"><a href="#__codelineno-17-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a>    &lt;build&gt;
<a id="__codelineno-17-2" name="__codelineno-17-2"></a>        &lt;plugins&gt;
<a id="__codelineno-17-3" name="__codelineno-17-3"></a>            &lt;plugin&gt;
<a id="__codelineno-17-4" name="__codelineno-17-4"></a>                &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;
<a id="__codelineno-17-5" name="__codelineno-17-5"></a>                &lt;configuration&gt;
<a id="__codelineno-17-6" name="__codelineno-17-6"></a>                    &lt;descriptorRefs&gt;
<a id="__codelineno-17-7" name="__codelineno-17-7"></a>                        &lt;descriptorRef&gt;jar-with-dependencies&lt;/descriptorRef&gt;
<a id="__codelineno-17-8" name="__codelineno-17-8"></a>                    &lt;/descriptorRefs&gt;
<a id="__codelineno-17-9" name="__codelineno-17-9"></a>                &lt;/configuration&gt;
<a id="__codelineno-17-10" name="__codelineno-17-10"></a>            &lt;/plugin&gt;
<a id="__codelineno-17-11" name="__codelineno-17-11"></a>            &lt;plugin&gt;
<a id="__codelineno-17-12" name="__codelineno-17-12"></a>                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
<a id="__codelineno-17-13" name="__codelineno-17-13"></a>                &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
<a id="__codelineno-17-14" name="__codelineno-17-14"></a>                &lt;version&gt;2.18.1&lt;/version&gt;
<a id="__codelineno-17-15" name="__codelineno-17-15"></a>            &lt;/plugin&gt;
<a id="__codelineno-17-16" name="__codelineno-17-16"></a>        &lt;/plugins&gt;
<a id="__codelineno-17-17" name="__codelineno-17-17"></a>&lt;/build&gt;
</code></pre></div></td></tr></table></div>
<p>Elles définissent le plugin de Maven capable de générer l'artifact du projet avec ses dépendances. Ensuite on procède de la façon suivante [1-6] :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000004140000047AD0AD5777.png" style="display:inline-block; margin:4px;width:13.811cm;height:15.161cm;" /></td></tr></table>

<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000003DB0000018947338836.png" style="display:inline-block; margin:4px;width:13.058cm;height:5.2cm;" /></td></tr></table>

<ul>
<li>[4-6] représentent une configuration d'exécution Maven ;</li>
<li>en [4], mettre un nom quelconque ;</li>
<li>en [5], désigner le dossier du projet ;</li>
<li>en [6], mettre les cibles Maven (goals) :</li>
<li>[clean] : le dossier [target] du projet est supprimé ;</li>
<li>[compile] : le projet est compilé. Les produits de la compilation sont placés dans un dossier [target] régénéré ;</li>
<li>[assembly:single] : les classes du projet et de ses dépendances sont placées dans une unique archive jar dans le dossier [target] ;</li>
</ul>
<p>Après exécution, on obtient le résultat suivant :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000005580000046E37D883F0.png" style="display:inline-block; margin:4px;width:17.999cm;height:14.919cm;" /></td></tr></table>

<p>Une archive jar est un fichier zippé qu'on peut donc ouvrir avec un dézippeur. Une fois l'archive précédente dézippée, on obtient l'arborescence suivante :</p>
<ul>
<li>en [8], les classes des dépendances du projet ;</li>
<li>en [9], les classes du projet lui-même ;</li>
</ul>
<h2 id="55-exemple-04">5.5. Exemple-04</h2>
<h3 id="551-objectif">5.5.1. Objectif</h3>
<p>Cet exemple reprend l'un de ceux présentés dans le document [<a href="http://tahe.developpez.com/java/springioc"><u>Introduction à Spring IoC</u></a>] dans lequel on montre l'apport de Spring pour la configuration d'architectures multi-couche. Dans le document original, l'exemple est traité avec une configuration Spring faite avec un fichier XML. Ici nous traitons l'exemple avec une configuration par classes Java et annotations.</p>
<p>On veut ici configurer un projet Spring pour l'architecture suivante:</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000003A8000001140AB5014D.png" style="display:inline-block; margin:4px;width:12.383cm;height:3.651cm;" /></td></tr></table>

<p>Chaque couche présente une interface implémentée avec deux classes. On veut montrer que grâce à Spring, on peut changer l'implémentation d'une couche avec un impact zéro sur le code des autres couches.</p>
<h3 id="552-le-projet-eclipse">5.5.2. Le projet Eclipse</h3>
<h4 id="5521-generation">5.5.2.1. Génération</h4>
<p>Nous créons un nouveau type de projet :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000004260000018E130332EF.png" style="display:inline-block; margin:4px;width:14.049cm;height:5.265cm;" /></td></tr></table>

<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000003A4000004344FBDC476.png" style="display:inline-block; margin:4px;width:12.33cm;height:14.235cm;" /></td></tr></table>

<ul>
<li>en  [4], mettre le nom du projet Eclipse ;</li>
<li>en [5], choisir un projet Maven ;</li>
<li>en [6], choisir une version de Java &gt;=1.7 ;</li>
<li>en [7], choisir la version de Spring Boot proposée ;</li>
<li>les informations [8-11] sont des informations Maven ;</li>
<li>en [12], on peut choisir une ou plusieurs des dépendances proposées. Cela va avoir pour effet d'intégrer dans le fichier [pom.xml] de Maven, un certain nombre de dépendances ;</li>
</ul>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000005F8000001EA2ACC3E6A.png" style="display:inline-block; margin:4px;width:17.999cm;height:5.771cm;" /></td></tr></table>

<ul>
<li>en [13], désigner un dossier existant et vide pour accueillir le projet ;</li>
<li>en [14], le projet généré. Nous allons en disséquer les éléments ;</li>
</ul>
<p>Le projet est un projet Maven configuré par le fichier [pom.xml] suivant :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-18-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-18-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-18-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-18-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-18-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-18-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-18-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-18-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-18-10">10</a></span>
<span class="normal"><a href="#__codelineno-18-11">11</a></span>
<span class="normal"><a href="#__codelineno-18-12">12</a></span>
<span class="normal"><a href="#__codelineno-18-13">13</a></span>
<span class="normal"><a href="#__codelineno-18-14">14</a></span>
<span class="normal"><a href="#__codelineno-18-15">15</a></span>
<span class="normal"><a href="#__codelineno-18-16">16</a></span>
<span class="normal"><a href="#__codelineno-18-17">17</a></span>
<span class="normal"><a href="#__codelineno-18-18">18</a></span>
<span class="normal"><a href="#__codelineno-18-19">19</a></span>
<span class="normal"><a href="#__codelineno-18-20">20</a></span>
<span class="normal"><a href="#__codelineno-18-21">21</a></span>
<span class="normal"><a href="#__codelineno-18-22">22</a></span>
<span class="normal"><a href="#__codelineno-18-23">23</a></span>
<span class="normal"><a href="#__codelineno-18-24">24</a></span>
<span class="normal"><a href="#__codelineno-18-25">25</a></span>
<span class="normal"><a href="#__codelineno-18-26">26</a></span>
<span class="normal"><a href="#__codelineno-18-27">27</a></span>
<span class="normal"><a href="#__codelineno-18-28">28</a></span>
<span class="normal"><a href="#__codelineno-18-29">29</a></span>
<span class="normal"><a href="#__codelineno-18-30">30</a></span>
<span class="normal"><a href="#__codelineno-18-31">31</a></span>
<span class="normal"><a href="#__codelineno-18-32">32</a></span>
<span class="normal"><a href="#__codelineno-18-33">33</a></span>
<span class="normal"><a href="#__codelineno-18-34">34</a></span>
<span class="normal"><a href="#__codelineno-18-35">35</a></span>
<span class="normal"><a href="#__codelineno-18-36">36</a></span>
<span class="normal"><a href="#__codelineno-18-37">37</a></span>
<span class="normal"><a href="#__codelineno-18-38">38</a></span>
<span class="normal"><a href="#__codelineno-18-39">39</a></span>
<span class="normal"><a href="#__codelineno-18-40">40</a></span>
<span class="normal"><a href="#__codelineno-18-41">41</a></span>
<span class="normal"><a href="#__codelineno-18-42">42</a></span>
<span class="normal"><a href="#__codelineno-18-43">43</a></span>
<span class="normal"><a href="#__codelineno-18-44">44</a></span>
<span class="normal"><a href="#__codelineno-18-45">45</a></span>
<span class="normal"><a href="#__codelineno-18-46">46</a></span>
<span class="normal"><a href="#__codelineno-18-47">47</a></span>
<span class="normal"><a href="#__codelineno-18-48">48</a></span>
<span class="normal"><a href="#__codelineno-18-49">49</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<a id="__codelineno-18-2" name="__codelineno-18-2"></a><span class="nt">&lt;project</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;http://maven.apache.org/POM/4.0.0&quot;</span><span class="w"> </span><span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
<a id="__codelineno-18-3" name="__codelineno-18-3"></a><span class="w">    </span><span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span><span class="nt">&gt;</span>
<a id="__codelineno-18-4" name="__codelineno-18-4"></a><span class="w">    </span><span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
<a id="__codelineno-18-5" name="__codelineno-18-5"></a>
<a id="__codelineno-18-6" name="__codelineno-18-6"></a><span class="w">    </span><span class="nt">&lt;groupId&gt;</span>istia.st.spring.core<span class="nt">&lt;/groupId&gt;</span>
<a id="__codelineno-18-7" name="__codelineno-18-7"></a><span class="w">    </span><span class="nt">&lt;artifactId&gt;</span>spring-core-04<span class="nt">&lt;/artifactId&gt;</span>
<a id="__codelineno-18-8" name="__codelineno-18-8"></a><span class="w">    </span><span class="nt">&lt;version&gt;</span>0.0.1-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
<a id="__codelineno-18-9" name="__codelineno-18-9"></a><span class="w">    </span><span class="nt">&lt;packaging&gt;</span>jar<span class="nt">&lt;/packaging&gt;</span>
<a id="__codelineno-18-10" name="__codelineno-18-10"></a>
<a id="__codelineno-18-11" name="__codelineno-18-11"></a><span class="w">    </span><span class="nt">&lt;name&gt;</span>spring-core-04<span class="nt">&lt;/name&gt;</span>
<a id="__codelineno-18-12" name="__codelineno-18-12"></a><span class="w">    </span><span class="nt">&lt;description&gt;</span>Programmation<span class="w"> </span>par<span class="w"> </span>interfaces<span class="nt">&lt;/description&gt;</span>
<a id="__codelineno-18-13" name="__codelineno-18-13"></a>
<a id="__codelineno-18-14" name="__codelineno-18-14"></a><span class="w">    </span><span class="nt">&lt;parent&gt;</span>
<a id="__codelineno-18-15" name="__codelineno-18-15"></a><span class="w">        </span><span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
<a id="__codelineno-18-16" name="__codelineno-18-16"></a><span class="w">        </span><span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-parent<span class="nt">&lt;/artifactId&gt;</span>
<a id="__codelineno-18-17" name="__codelineno-18-17"></a><span class="w">        </span><span class="nt">&lt;version&gt;</span>1.2.3.RELEASE<span class="nt">&lt;/version&gt;</span>
<a id="__codelineno-18-18" name="__codelineno-18-18"></a><span class="w">        </span><span class="nt">&lt;relativePath/&gt;</span><span class="w"> </span><span class="cm">&lt;!-- lookup parent from repository --&gt;</span>
<a id="__codelineno-18-19" name="__codelineno-18-19"></a><span class="w">    </span><span class="nt">&lt;/parent&gt;</span>
<a id="__codelineno-18-20" name="__codelineno-18-20"></a>
<a id="__codelineno-18-21" name="__codelineno-18-21"></a><span class="w">    </span><span class="nt">&lt;properties&gt;</span>
<a id="__codelineno-18-22" name="__codelineno-18-22"></a><span class="w">        </span><span class="nt">&lt;project.build.sourceEncoding&gt;</span>UTF-8<span class="nt">&lt;/project.build.sourceEncoding&gt;</span>
<a id="__codelineno-18-23" name="__codelineno-18-23"></a><span class="w">        </span><span class="nt">&lt;start-class&gt;</span>demo.SpringCore04Application<span class="nt">&lt;/start-class&gt;</span>
<a id="__codelineno-18-24" name="__codelineno-18-24"></a><span class="w">        </span><span class="nt">&lt;java.version&gt;</span>1.8<span class="nt">&lt;/java.version&gt;</span>
<a id="__codelineno-18-25" name="__codelineno-18-25"></a><span class="w">    </span><span class="nt">&lt;/properties&gt;</span>
<a id="__codelineno-18-26" name="__codelineno-18-26"></a>
<a id="__codelineno-18-27" name="__codelineno-18-27"></a><span class="w">    </span><span class="nt">&lt;dependencies&gt;</span>
<a id="__codelineno-18-28" name="__codelineno-18-28"></a><span class="w">        </span><span class="nt">&lt;dependency&gt;</span>
<a id="__codelineno-18-29" name="__codelineno-18-29"></a><span class="w">            </span><span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
<a id="__codelineno-18-30" name="__codelineno-18-30"></a><span class="w">            </span><span class="nt">&lt;artifactId&gt;</span>spring-boot-starter<span class="nt">&lt;/artifactId&gt;</span>
<a id="__codelineno-18-31" name="__codelineno-18-31"></a><span class="w">        </span><span class="nt">&lt;/dependency&gt;</span>
<a id="__codelineno-18-32" name="__codelineno-18-32"></a>
<a id="__codelineno-18-33" name="__codelineno-18-33"></a><span class="w">        </span><span class="nt">&lt;dependency&gt;</span>
<a id="__codelineno-18-34" name="__codelineno-18-34"></a><span class="w">            </span><span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
<a id="__codelineno-18-35" name="__codelineno-18-35"></a><span class="w">            </span><span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-test<span class="nt">&lt;/artifactId&gt;</span>
<a id="__codelineno-18-36" name="__codelineno-18-36"></a><span class="w">            </span><span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
<a id="__codelineno-18-37" name="__codelineno-18-37"></a><span class="w">        </span><span class="nt">&lt;/dependency&gt;</span>
<a id="__codelineno-18-38" name="__codelineno-18-38"></a><span class="w">    </span><span class="nt">&lt;/dependencies&gt;</span>
<a id="__codelineno-18-39" name="__codelineno-18-39"></a>
<a id="__codelineno-18-40" name="__codelineno-18-40"></a><span class="w">    </span><span class="nt">&lt;build&gt;</span>
<a id="__codelineno-18-41" name="__codelineno-18-41"></a><span class="w">        </span><span class="nt">&lt;plugins&gt;</span>
<a id="__codelineno-18-42" name="__codelineno-18-42"></a><span class="w">            </span><span class="nt">&lt;plugin&gt;</span>
<a id="__codelineno-18-43" name="__codelineno-18-43"></a><span class="w">                </span><span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
<a id="__codelineno-18-44" name="__codelineno-18-44"></a><span class="w">                </span><span class="nt">&lt;artifactId&gt;</span>spring-boot-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
<a id="__codelineno-18-45" name="__codelineno-18-45"></a><span class="w">            </span><span class="nt">&lt;/plugin&gt;</span>
<a id="__codelineno-18-46" name="__codelineno-18-46"></a><span class="w">        </span><span class="nt">&lt;/plugins&gt;</span>
<a id="__codelineno-18-47" name="__codelineno-18-47"></a><span class="w">    </span><span class="nt">&lt;/build&gt;</span>
<a id="__codelineno-18-48" name="__codelineno-18-48"></a>
<a id="__codelineno-18-49" name="__codelineno-18-49"></a><span class="nt">&lt;/project&gt;</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>lignes 6-12 : reprennent les informations saisies dans l'assistant de réation du projet ;</li>
<li>lignes 14-19 : le projet Maven parent qui définit un certain nombre de bibliothèques avec leurs versions. Si l'une d'elles est une dépendance du projet, elle est mentionnée dans le fichier [pom.xml] sans sa version ;</li>
<li>ligne 23 : cette ligne ne sert que si on a l'intention de générer une archive exécutable du projet. Elle est inutilisée sinon ;</li>
<li>lignes 28-31 : la dépendance minimale d'un projet Spring Boot. On rappelle que nous n'avons sélectionné aucune dépendance dans la liste à cocher ;</li>
<li>lignes 33-37 : la dépendance nécessaire pour gérer des tests unitaires JUnit [<a href="http://junit.org/"><u>http://junit.org/</u></a>] intégrés avec Spring. La ligne 36 indique que la dépendance n'est nécessaire que pour les tests. En conséquence, elle ne sera pas intégrée à l'archive du projet ;</li>
<li>lignes 42-45 : le plugin qui permet de générer l'artifact Maven du projet ;</li>
</ul>
<p>La liste des dépendances amenée par ce fichier est la suivante [1] :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000025D000003AABD00222B.png" style="display:inline-block; margin:4px;width:8.005cm;height:12.409cm;" /></td></tr></table>

<p>Nous allons voir qu'elles sont suffisantes pour ce qu'on veut faire ici.</p>
<h4 id="5522-la-classe-executable">5.5.2.2. La classe exécutable</h4>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000010C0000006E9AA449A7.png" style="display:inline-block; margin:4px;width:4.96cm;height:2.041cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr></table>

<p>La classe exécutable [SpringCore04Application] [[2] est la suivante :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-19-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-19-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-19-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-19-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-19-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-19-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-19-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-19-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-19-10">10</a></span>
<span class="normal"><a href="#__codelineno-19-11">11</a></span>
<span class="normal"><a href="#__codelineno-19-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">demo</span><span class="p">;</span>
<a id="__codelineno-19-2" name="__codelineno-19-2"></a>
<a id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.boot.SpringApplication</span><span class="p">;</span>
<a id="__codelineno-19-4" name="__codelineno-19-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.boot.autoconfigure.SpringBootApplication</span><span class="p">;</span>
<a id="__codelineno-19-5" name="__codelineno-19-5"></a>
<a id="__codelineno-19-6" name="__codelineno-19-6"></a><span class="nd">@SpringBootApplication</span>
<a id="__codelineno-19-7" name="__codelineno-19-7"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SpringCore04Application</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-19-8" name="__codelineno-19-8"></a>
<a id="__codelineno-19-9" name="__codelineno-19-9"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-19-10" name="__codelineno-19-10"></a><span class="w">        </span><span class="n">SpringApplication</span><span class="p">.</span><span class="na">run</span><span class="p">(</span><span class="n">SpringCore04Application</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
<a id="__codelineno-19-11" name="__codelineno-19-11"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-19-12" name="__codelineno-19-12"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 6, l'annotation [@SpringBootApplication] est un raccourci pour les trois annotations [@Configuration, @EnableAutoConfiguration, @ComponentScan] ce qui signifie :</li>
<li>que la classe [SpringCore04Application] est une classe de configuration Spring ;</li>
<li>qu'il est demandé à Spring Boot d'opérer des configurations à partir des classes qu'il va trouver dans le Classpath du projet, donc ici dans les dépendances Maven ;</li>
<li>d'examiner le dossier courant (celui de la classe [SpringCore04Application]) pour y trouver d'éventuels autres composants Spring ;</li>
<li>ligne 10 : la méthode statique [SpringApplication.run] est exécutée. Son premier paramètre est une classe de configuration Spring, ici la classe [SpringCore04Application]. Son deuxième paramètre est ici la liste des arguments passés à la méthode [main] (ligne 9). La méthode statique [SpringApplication.run] a pour rôle de créer le contexte Spring, ç-à-d créer les différents beans trouvés soit dans les classes de configuration soit dans les dossiers explorés par l'annotation [@ComponentScan]. La méthode [main] ici ne fait rien d'autre. Pour lui donner un peu plus de substance, nous allons la transformer de la façon suivante :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-20-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-20-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-20-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-20-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-20-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-20-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-20-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-20-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-20-10">10</a></span>
<span class="normal"><a href="#__codelineno-20-11">11</a></span>
<span class="normal"><a href="#__codelineno-20-12">12</a></span>
<span class="normal"><a href="#__codelineno-20-13">13</a></span>
<span class="normal"><a href="#__codelineno-20-14">14</a></span>
<span class="normal"><a href="#__codelineno-20-15">15</a></span>
<span class="normal"><a href="#__codelineno-20-16">16</a></span>
<span class="normal"><a href="#__codelineno-20-17">17</a></span>
<span class="normal"><a href="#__codelineno-20-18">18</a></span>
<span class="normal"><a href="#__codelineno-20-19">19</a></span>
<span class="normal"><a href="#__codelineno-20-20">20</a></span>
<span class="normal"><a href="#__codelineno-20-21">21</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">demo</span><span class="p">;</span>
<a id="__codelineno-20-2" name="__codelineno-20-2"></a>
<a id="__codelineno-20-3" name="__codelineno-20-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.boot.SpringApplication</span><span class="p">;</span>
<a id="__codelineno-20-4" name="__codelineno-20-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.boot.autoconfigure.SpringBootApplication</span><span class="p">;</span>
<a id="__codelineno-20-5" name="__codelineno-20-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.ConfigurableApplicationContext</span><span class="p">;</span>
<a id="__codelineno-20-6" name="__codelineno-20-6"></a>
<a id="__codelineno-20-7" name="__codelineno-20-7"></a><span class="nd">@SpringBootApplication</span>
<a id="__codelineno-20-8" name="__codelineno-20-8"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SpringCore04Application</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-20-9" name="__codelineno-20-9"></a>
<a id="__codelineno-20-10" name="__codelineno-20-10"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-20-11" name="__codelineno-20-11"></a><span class="w">        </span><span class="c1">// instanciation du contexte Spring</span>
<a id="__codelineno-20-12" name="__codelineno-20-12"></a><span class="w">        </span><span class="n">ConfigurableApplicationContext</span><span class="w"> </span><span class="n">context</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SpringApplication</span><span class="p">.</span><span class="na">run</span><span class="p">(</span><span class="n">SpringCore04Application</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
<a id="__codelineno-20-13" name="__codelineno-20-13"></a><span class="w">        </span><span class="c1">// affichage du contexte</span>
<a id="__codelineno-20-14" name="__codelineno-20-14"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;---------------- Liste des beans Spring&quot;</span><span class="p">);</span>
<a id="__codelineno-20-15" name="__codelineno-20-15"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">beanName</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="na">getBeanDefinitionNames</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-20-16" name="__codelineno-20-16"></a><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">beanName</span><span class="p">);</span>
<a id="__codelineno-20-17" name="__codelineno-20-17"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-20-18" name="__codelineno-20-18"></a><span class="w">        </span><span class="c1">// fermeture contexte</span>
<a id="__codelineno-20-19" name="__codelineno-20-19"></a><span class="w">        </span><span class="n">context</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
<a id="__codelineno-20-20" name="__codelineno-20-20"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-20-21" name="__codelineno-20-21"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 12 : la méthode statique [SpringApplication.run] rend le contexte Spring qu'elle a construit ;</li>
<li>lignes 15-17 : on affiche le nom de tous les beans de ce contexte ;</li>
</ul>
<p>On peut exécuter l'application de la façon suivante [1-3]. La méthode habituelle [Run As Java Application] est également valide.</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/1000000000000406000004EA30706C3E.png" style="display:inline-block; margin:4px;width:13.626cm;height:16.642cm;" /></td></tr></table>

<p>On obtient le résultat suivant :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-21-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-21-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-21-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-21-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-21-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-21-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-21-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-21-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-21-10">10</a></span>
<span class="normal"><a href="#__codelineno-21-11">11</a></span>
<span class="normal"><a href="#__codelineno-21-12">12</a></span>
<span class="normal"><a href="#__codelineno-21-13">13</a></span>
<span class="normal"><a href="#__codelineno-21-14">14</a></span>
<span class="normal"><a href="#__codelineno-21-15">15</a></span>
<span class="normal"><a href="#__codelineno-21-16">16</a></span>
<span class="normal"><a href="#__codelineno-21-17">17</a></span>
<span class="normal"><a href="#__codelineno-21-18">18</a></span>
<span class="normal"><a href="#__codelineno-21-19">19</a></span>
<span class="normal"><a href="#__codelineno-21-20">20</a></span>
<span class="normal"><a href="#__codelineno-21-21">21</a></span>
<span class="normal"><a href="#__codelineno-21-22">22</a></span>
<span class="normal"><a href="#__codelineno-21-23">23</a></span>
<span class="normal"><a href="#__codelineno-21-24">24</a></span>
<span class="normal"><a href="#__codelineno-21-25">25</a></span>
<span class="normal"><a href="#__codelineno-21-26">26</a></span>
<span class="normal"><a href="#__codelineno-21-27">27</a></span>
<span class="normal"><a href="#__codelineno-21-28">28</a></span>
<span class="normal"><a href="#__codelineno-21-29">29</a></span>
<span class="normal"><a href="#__codelineno-21-30">30</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1"></a>  .   ____          _            __ _ _
<a id="__codelineno-21-2" name="__codelineno-21-2"></a> /\\ / ___&#39;_ __ _ _(_)_ __  __ _ \ \ \ \
<a id="__codelineno-21-3" name="__codelineno-21-3"></a>( ( )\___ | &#39;_ | &#39;_| | &#39;_ \/ _` | \ \ \ \
<a id="__codelineno-21-4" name="__codelineno-21-4"></a> \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
<a id="__codelineno-21-5" name="__codelineno-21-5"></a>  &#39;  |____| .__|_| |_|_| |_\__, | / / / /
<a id="__codelineno-21-6" name="__codelineno-21-6"></a> =========|_|==============|___/=/_/_/_/
<a id="__codelineno-21-7" name="__codelineno-21-7"></a> :: Spring Boot ::        (v1.2.3.RELEASE)
<a id="__codelineno-21-8" name="__codelineno-21-8"></a>
<a id="__codelineno-21-9" name="__codelineno-21-9"></a>2015-04-08 11:18:38.254  INFO 4796 --- [           main] demo.SpringCore04Application             : Starting SpringCore04Application on Gportpers3 with PID 4796 (D:\data\istia-1415\polys\istia\dvp-spring-database\codes\original\intro-spring-core\spring-core-04\target\classes started by ST in D:\data\istia-1415\polys\istia\dvp-spring-database\codes\original\intro-spring-core\spring-core-04)
<a id="__codelineno-21-10" name="__codelineno-21-10"></a>2015-04-08 11:18:38.295  INFO 4796 --- [           main] s.c.a.AnnotationConfigApplicationContext : Refreshing org.springframework.context.annotation.AnnotationConfigApplicationContext@64485a47: startup date [Wed Apr 08 11:18:38 CEST 2015]; root of context hierarchy
<a id="__codelineno-21-11" name="__codelineno-21-11"></a>2015-04-08 11:18:38.776  INFO 4796 --- [           main] o.s.j.e.a.AnnotationMBeanExporter        : Registering beans for JMX exposure on startup
<a id="__codelineno-21-12" name="__codelineno-21-12"></a>2015-04-08 11:18:38.788  INFO 4796 --- [           main] demo.SpringCore04Application             : Started SpringCore04Application in 0.773 seconds (JVM running for 1.335)
<a id="__codelineno-21-13" name="__codelineno-21-13"></a>---------------- Liste des beans Spring
<a id="__codelineno-21-14" name="__codelineno-21-14"></a>org.springframework.context.annotation.internalConfigurationAnnotationProcessor
<a id="__codelineno-21-15" name="__codelineno-21-15"></a>org.springframework.context.annotation.internalAutowiredAnnotationProcessor
<a id="__codelineno-21-16" name="__codelineno-21-16"></a>org.springframework.context.annotation.internalRequiredAnnotationProcessor
<a id="__codelineno-21-17" name="__codelineno-21-17"></a>org.springframework.context.annotation.internalCommonAnnotationProcessor
<a id="__codelineno-21-18" name="__codelineno-21-18"></a>springCore04Application
<a id="__codelineno-21-19" name="__codelineno-21-19"></a>org.springframework.context.annotation.ConfigurationClassPostProcessor.importAwareProcessor
<a id="__codelineno-21-20" name="__codelineno-21-20"></a>org.springframework.context.annotation.ConfigurationClassPostProcessor.enhancedConfigurationProcessor
<a id="__codelineno-21-21" name="__codelineno-21-21"></a>org.springframework.boot.autoconfigure.AutoConfigurationPackages
<a id="__codelineno-21-22" name="__codelineno-21-22"></a>org.springframework.boot.autoconfigure.PropertyPlaceholderAutoConfiguration
<a id="__codelineno-21-23" name="__codelineno-21-23"></a>org.springframework.boot.autoconfigure.condition.BeanTypeRegistry
<a id="__codelineno-21-24" name="__codelineno-21-24"></a>propertySourcesPlaceholderConfigurer
<a id="__codelineno-21-25" name="__codelineno-21-25"></a>org.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration
<a id="__codelineno-21-26" name="__codelineno-21-26"></a>mbeanExporter
<a id="__codelineno-21-27" name="__codelineno-21-27"></a>objectNamingStrategy
<a id="__codelineno-21-28" name="__codelineno-21-28"></a>mbeanServer
<a id="__codelineno-21-29" name="__codelineno-21-29"></a>2015-04-08 11:18:38.789  INFO 4796 --- [           main] s.c.a.AnnotationConfigApplicationContext : Closing org.springframework.context.annotation.AnnotationConfigApplicationContext@64485a47: startup date [Wed Apr 08 11:18:38 CEST 2015]; root of context hierarchy
<a id="__codelineno-21-30" name="__codelineno-21-30"></a>2015-04-08 11:18:38.790  INFO 4796 --- [           main] o.s.j.e.a.AnnotationMBeanExporter        : Unregistering JMX-exposed beans on shutdown
</code></pre></div></td></tr></table></div>
<ul>
<li>lignes 14-28 : les beans du contexte Spring. Nous ne connaissons pas leur rôle. Nous retrouvons le bean [springCore04Application] ligne 18 qui de par son annotation [@SpringBootApplication] devient automatiquement un bean Spring ;</li>
<li>les autres lignes sont des logs de Spring de niveau [INFO]. Comme nous l'avons déjà vu, ces logs peuvent être contrôlés par le fichier [logback.xml] placé dans le Classpath du projet :</li>
</ul>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000000E5000000CED8D6CD16.png" style="display:inline-block; margin:4px;width:4.24cm;height:3.821cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr></table>

<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-22-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-22-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-22-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-22-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-22-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-22-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-22-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-22-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-22-10">10</a></span>
<span class="normal"><a href="#__codelineno-22-11">11</a></span>
<span class="normal"><a href="#__codelineno-22-12">12</a></span>
<span class="normal"><a href="#__codelineno-22-13">13</a></span>
<span class="normal"><a href="#__codelineno-22-14">14</a></span>
<span class="normal"><a href="#__codelineno-22-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1"></a>&lt;configuration&gt; 
<a id="__codelineno-22-2" name="__codelineno-22-2"></a>
<a id="__codelineno-22-3" name="__codelineno-22-3"></a>  &lt;appender name=&quot;STDOUT&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt; 
<a id="__codelineno-22-4" name="__codelineno-22-4"></a>    &lt;!-- encoders are  by default assigned the type
<a id="__codelineno-22-5" name="__codelineno-22-5"></a>         ch.qos.logback.classic.encoder.PatternLayoutEncoder --&gt;
<a id="__codelineno-22-6" name="__codelineno-22-6"></a>    &lt;encoder&gt;
<a id="__codelineno-22-7" name="__codelineno-22-7"></a>      &lt;pattern&gt;%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n&lt;/pattern&gt;
<a id="__codelineno-22-8" name="__codelineno-22-8"></a>    &lt;/encoder&gt;
<a id="__codelineno-22-9" name="__codelineno-22-9"></a>  &lt;/appender&gt;
<a id="__codelineno-22-10" name="__codelineno-22-10"></a>
<a id="__codelineno-22-11" name="__codelineno-22-11"></a>  &lt;!-- contrôle niveau des logs --&gt;
<a id="__codelineno-22-12" name="__codelineno-22-12"></a>  &lt;root level=&quot;warn&quot;&gt; &lt;!-- info, debug, warn --&gt;
<a id="__codelineno-22-13" name="__codelineno-22-13"></a>    &lt;appender-ref ref=&quot;STDOUT&quot; /&gt;
<a id="__codelineno-22-14" name="__codelineno-22-14"></a>  &lt;/root&gt;
<a id="__codelineno-22-15" name="__codelineno-22-15"></a>&lt;/configuration&gt;
</code></pre></div></td></tr></table></div>
<p>Si ligne 12 ci-dessus, on met le niveau [warn] à la place de [info], on obtient le résultat suivant :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-23-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-23-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-23-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-23-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-23-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-23-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-23-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-23-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-23-10">10</a></span>
<span class="normal"><a href="#__codelineno-23-11">11</a></span>
<span class="normal"><a href="#__codelineno-23-12">12</a></span>
<span class="normal"><a href="#__codelineno-23-13">13</a></span>
<span class="normal"><a href="#__codelineno-23-14">14</a></span>
<span class="normal"><a href="#__codelineno-23-15">15</a></span>
<span class="normal"><a href="#__codelineno-23-16">16</a></span>
<span class="normal"><a href="#__codelineno-23-17">17</a></span>
<span class="normal"><a href="#__codelineno-23-18">18</a></span>
<span class="normal"><a href="#__codelineno-23-19">19</a></span>
<span class="normal"><a href="#__codelineno-23-20">20</a></span>
<span class="normal"><a href="#__codelineno-23-21">21</a></span>
<span class="normal"><a href="#__codelineno-23-22">22</a></span>
<span class="normal"><a href="#__codelineno-23-23">23</a></span>
<span class="normal"><a href="#__codelineno-23-24">24</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1"></a>  .   ____          _            __ _ _
<a id="__codelineno-23-2" name="__codelineno-23-2"></a> /\\ / ___&#39;_ __ _ _(_)_ __  __ _ \ \ \ \
<a id="__codelineno-23-3" name="__codelineno-23-3"></a>( ( )\___ | &#39;_ | &#39;_| | &#39;_ \/ _` | \ \ \ \
<a id="__codelineno-23-4" name="__codelineno-23-4"></a> \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
<a id="__codelineno-23-5" name="__codelineno-23-5"></a>  &#39;  |____| .__|_| |_|_| |_\__, | / / / /
<a id="__codelineno-23-6" name="__codelineno-23-6"></a> =========|_|==============|___/=/_/_/_/
<a id="__codelineno-23-7" name="__codelineno-23-7"></a> :: Spring Boot ::        (v1.2.3.RELEASE)
<a id="__codelineno-23-8" name="__codelineno-23-8"></a>
<a id="__codelineno-23-9" name="__codelineno-23-9"></a>---------------- Liste des beans Spring
<a id="__codelineno-23-10" name="__codelineno-23-10"></a>org.springframework.context.annotation.internalConfigurationAnnotationProcessor
<a id="__codelineno-23-11" name="__codelineno-23-11"></a>org.springframework.context.annotation.internalAutowiredAnnotationProcessor
<a id="__codelineno-23-12" name="__codelineno-23-12"></a>org.springframework.context.annotation.internalRequiredAnnotationProcessor
<a id="__codelineno-23-13" name="__codelineno-23-13"></a>org.springframework.context.annotation.internalCommonAnnotationProcessor
<a id="__codelineno-23-14" name="__codelineno-23-14"></a>springCore04Application
<a id="__codelineno-23-15" name="__codelineno-23-15"></a>org.springframework.context.annotation.ConfigurationClassPostProcessor.importAwareProcessor
<a id="__codelineno-23-16" name="__codelineno-23-16"></a>org.springframework.context.annotation.ConfigurationClassPostProcessor.enhancedConfigurationProcessor
<a id="__codelineno-23-17" name="__codelineno-23-17"></a>org.springframework.boot.autoconfigure.AutoConfigurationPackages
<a id="__codelineno-23-18" name="__codelineno-23-18"></a>org.springframework.boot.autoconfigure.PropertyPlaceholderAutoConfiguration
<a id="__codelineno-23-19" name="__codelineno-23-19"></a>org.springframework.boot.autoconfigure.condition.BeanTypeRegistry
<a id="__codelineno-23-20" name="__codelineno-23-20"></a>propertySourcesPlaceholderConfigurer
<a id="__codelineno-23-21" name="__codelineno-23-21"></a>org.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration
<a id="__codelineno-23-22" name="__codelineno-23-22"></a>mbeanExporter
<a id="__codelineno-23-23" name="__codelineno-23-23"></a>objectNamingStrategy
<a id="__codelineno-23-24" name="__codelineno-23-24"></a>mbeanServer
</code></pre></div></td></tr></table></div>
<p>Les logs ont disparu. N'apparaissent que les messages de niveau [warn] et ici il n'y en pas eu.</p>
<h3 id="553-implementation-des-differentes-couches-de-larchitecture">5.5.3. Implémentation des différentes couches de l'architecture</h3>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000003610000011091378F1C.png" style="display:inline-block; margin:4px;width:11.444cm;height:3.598cm;" /></td></tr></table>

<p>Nous allons maintenant implémenter les trois couches de l'architecture ci-dessus :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000000F1000001B4DEDB64F6.png" style="display:inline-block; margin:4px;width:4.461cm;height:8.07cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr></table>

<p>La couche [DAO] est implémentée par le package [spring.core.dao]. Elle présente l'interface [IDao] suivante :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1">1</a></span>
<span class="normal"><a href="#__codelineno-24-2">2</a></span>
<span class="normal"><a href="#__codelineno-24-3">3</a></span>
<span class="normal"><a href="#__codelineno-24-4">4</a></span>
<span class="normal"><a href="#__codelineno-24-5">5</a></span>
<span class="normal"><a href="#__codelineno-24-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1"></a>package spring.core.dao;
<a id="__codelineno-24-2" name="__codelineno-24-2"></a>
<a id="__codelineno-24-3" name="__codelineno-24-3"></a>public interface IDao {
<a id="__codelineno-24-4" name="__codelineno-24-4"></a>
<a id="__codelineno-24-5" name="__codelineno-24-5"></a>    public int doSomethingInDaoLayer(int a, int b);
<a id="__codelineno-24-6" name="__codelineno-24-6"></a>}
</code></pre></div></td></tr></table></div>
<p>Cette interface a deux implémentations : [Dao1] et [Dao2] :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1">1</a></span>
<span class="normal"><a href="#__codelineno-25-2">2</a></span>
<span class="normal"><a href="#__codelineno-25-3">3</a></span>
<span class="normal"><a href="#__codelineno-25-4">4</a></span>
<span class="normal"><a href="#__codelineno-25-5">5</a></span>
<span class="normal"><a href="#__codelineno-25-6">6</a></span>
<span class="normal"><a href="#__codelineno-25-7">7</a></span>
<span class="normal"><a href="#__codelineno-25-8">8</a></span>
<span class="normal"><a href="#__codelineno-25-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1"></a>package spring.core.dao;
<a id="__codelineno-25-2" name="__codelineno-25-2"></a>
<a id="__codelineno-25-3" name="__codelineno-25-3"></a>public class Dao1 implements IDao {
<a id="__codelineno-25-4" name="__codelineno-25-4"></a>
<a id="__codelineno-25-5" name="__codelineno-25-5"></a>    public int doSomethingInDaoLayer(int a, int b) {
<a id="__codelineno-25-6" name="__codelineno-25-6"></a>        return a+b;
<a id="__codelineno-25-7" name="__codelineno-25-7"></a>    }
<a id="__codelineno-25-8" name="__codelineno-25-8"></a>
<a id="__codelineno-25-9" name="__codelineno-25-9"></a>}
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1">1</a></span>
<span class="normal"><a href="#__codelineno-26-2">2</a></span>
<span class="normal"><a href="#__codelineno-26-3">3</a></span>
<span class="normal"><a href="#__codelineno-26-4">4</a></span>
<span class="normal"><a href="#__codelineno-26-5">5</a></span>
<span class="normal"><a href="#__codelineno-26-6">6</a></span>
<span class="normal"><a href="#__codelineno-26-7">7</a></span>
<span class="normal"><a href="#__codelineno-26-8">8</a></span>
<span class="normal"><a href="#__codelineno-26-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1"></a>package spring.core.dao;
<a id="__codelineno-26-2" name="__codelineno-26-2"></a>
<a id="__codelineno-26-3" name="__codelineno-26-3"></a>public class Dao2 implements IDao {
<a id="__codelineno-26-4" name="__codelineno-26-4"></a>
<a id="__codelineno-26-5" name="__codelineno-26-5"></a>    public int doSomethingInDaoLayer(int a, int b) {
<a id="__codelineno-26-6" name="__codelineno-26-6"></a>        return a-b;
<a id="__codelineno-26-7" name="__codelineno-26-7"></a>    }
<a id="__codelineno-26-8" name="__codelineno-26-8"></a>
<a id="__codelineno-26-9" name="__codelineno-26-9"></a>}
</code></pre></div></td></tr></table></div>
<p>La couche [métier] est implémentée par le package [spring.core.metier]. Elle présente l'interface [IMetier] suivante :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1">1</a></span>
<span class="normal"><a href="#__codelineno-27-2">2</a></span>
<span class="normal"><a href="#__codelineno-27-3">3</a></span>
<span class="normal"><a href="#__codelineno-27-4">4</a></span>
<span class="normal"><a href="#__codelineno-27-5">5</a></span>
<span class="normal"><a href="#__codelineno-27-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1"></a>package spring.core.metier;
<a id="__codelineno-27-2" name="__codelineno-27-2"></a>
<a id="__codelineno-27-3" name="__codelineno-27-3"></a>public interface IMetier {
<a id="__codelineno-27-4" name="__codelineno-27-4"></a>
<a id="__codelineno-27-5" name="__codelineno-27-5"></a>    public int doSomethingInMetierLayer(int a, int b);
<a id="__codelineno-27-6" name="__codelineno-27-6"></a>}
</code></pre></div></td></tr></table></div>
<p>Cette interface a deux implémentations : [Metier1] et [Metier2] :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-28-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-28-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-28-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-28-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-28-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-28-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-28-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-28-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-28-10">10</a></span>
<span class="normal"><a href="#__codelineno-28-11">11</a></span>
<span class="normal"><a href="#__codelineno-28-12">12</a></span>
<span class="normal"><a href="#__codelineno-28-13">13</a></span>
<span class="normal"><a href="#__codelineno-28-14">14</a></span>
<span class="normal"><a href="#__codelineno-28-15">15</a></span>
<span class="normal"><a href="#__codelineno-28-16">16</a></span>
<span class="normal"><a href="#__codelineno-28-17">17</a></span>
<span class="normal"><a href="#__codelineno-28-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="n">package</span> <span class="n">spring</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">metier</span><span class="p">;</span>
<a id="__codelineno-28-2" name="__codelineno-28-2"></a>
<a id="__codelineno-28-3" name="__codelineno-28-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">spring.core.dao.IDao</span><span class="p">;</span>
<a id="__codelineno-28-4" name="__codelineno-28-4"></a>
<a id="__codelineno-28-5" name="__codelineno-28-5"></a><span class="n">public</span> <span class="k">class</span><span class="w"> </span><span class="nc">Metier1</span> <span class="n">implements</span> <span class="n">IMetier</span> <span class="p">{</span>
<a id="__codelineno-28-6" name="__codelineno-28-6"></a>
<a id="__codelineno-28-7" name="__codelineno-28-7"></a>    <span class="n">private</span> <span class="n">IDao</span> <span class="n">dao</span><span class="p">;</span>
<a id="__codelineno-28-8" name="__codelineno-28-8"></a>
<a id="__codelineno-28-9" name="__codelineno-28-9"></a>    <span class="n">public</span> <span class="nb">int</span> <span class="n">doSomethingInMetierLayer</span><span class="p">(</span><span class="nb">int</span> <span class="n">a</span><span class="p">,</span> <span class="nb">int</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-28-10" name="__codelineno-28-10"></a>        <span class="n">a</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-28-11" name="__codelineno-28-11"></a>        <span class="n">b</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-28-12" name="__codelineno-28-12"></a>        <span class="k">return</span> <span class="n">dao</span><span class="o">.</span><span class="n">doSomethingInDaoLayer</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
<a id="__codelineno-28-13" name="__codelineno-28-13"></a>    <span class="p">}</span>
<a id="__codelineno-28-14" name="__codelineno-28-14"></a>
<a id="__codelineno-28-15" name="__codelineno-28-15"></a>    <span class="n">public</span> <span class="n">void</span> <span class="n">setDao</span><span class="p">(</span><span class="n">IDao</span> <span class="n">dao</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-28-16" name="__codelineno-28-16"></a>        <span class="n">this</span><span class="o">.</span><span class="n">dao</span> <span class="o">=</span> <span class="n">dao</span><span class="p">;</span>
<a id="__codelineno-28-17" name="__codelineno-28-17"></a>    <span class="p">}</span>
<a id="__codelineno-28-18" name="__codelineno-28-18"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-29-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-29-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-29-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-29-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-29-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-29-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-29-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-29-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-29-10">10</a></span>
<span class="normal"><a href="#__codelineno-29-11">11</a></span>
<span class="normal"><a href="#__codelineno-29-12">12</a></span>
<span class="normal"><a href="#__codelineno-29-13">13</a></span>
<span class="normal"><a href="#__codelineno-29-14">14</a></span>
<span class="normal"><a href="#__codelineno-29-15">15</a></span>
<span class="normal"><a href="#__codelineno-29-16">16</a></span>
<span class="normal"><a href="#__codelineno-29-17">17</a></span>
<span class="normal"><a href="#__codelineno-29-18">18</a></span>
<span class="normal"><a href="#__codelineno-29-19">19</a></span>
<span class="normal"><a href="#__codelineno-29-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="n">package</span> <span class="n">spring</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">metier</span><span class="p">;</span>
<a id="__codelineno-29-2" name="__codelineno-29-2"></a>
<a id="__codelineno-29-3" name="__codelineno-29-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">spring.core.dao.IDao</span><span class="p">;</span>
<a id="__codelineno-29-4" name="__codelineno-29-4"></a>
<a id="__codelineno-29-5" name="__codelineno-29-5"></a><span class="n">public</span> <span class="k">class</span><span class="w"> </span><span class="nc">Metier2</span> <span class="n">implements</span> <span class="n">IMetier</span> <span class="p">{</span>
<a id="__codelineno-29-6" name="__codelineno-29-6"></a>
<a id="__codelineno-29-7" name="__codelineno-29-7"></a>    <span class="n">private</span> <span class="n">IDao</span> <span class="n">dao</span><span class="p">;</span>
<a id="__codelineno-29-8" name="__codelineno-29-8"></a>
<a id="__codelineno-29-9" name="__codelineno-29-9"></a>    <span class="n">public</span> <span class="nb">int</span> <span class="n">doSomethingInMetierLayer</span><span class="p">(</span><span class="nb">int</span> <span class="n">a</span><span class="p">,</span> <span class="nb">int</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-29-10" name="__codelineno-29-10"></a>        <span class="n">a</span><span class="o">--</span><span class="p">;</span>
<a id="__codelineno-29-11" name="__codelineno-29-11"></a>        <span class="n">b</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-29-12" name="__codelineno-29-12"></a>        <span class="k">return</span> <span class="n">dao</span><span class="o">.</span><span class="n">doSomethingInDaoLayer</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
<a id="__codelineno-29-13" name="__codelineno-29-13"></a>    <span class="p">}</span>
<a id="__codelineno-29-14" name="__codelineno-29-14"></a>
<a id="__codelineno-29-15" name="__codelineno-29-15"></a>    <span class="n">public</span> <span class="n">void</span> <span class="n">setDao</span><span class="p">(</span><span class="n">IDao</span> <span class="n">dao</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-29-16" name="__codelineno-29-16"></a>        <span class="n">this</span><span class="o">.</span><span class="n">dao</span> <span class="o">=</span> <span class="n">dao</span><span class="p">;</span>
<a id="__codelineno-29-17" name="__codelineno-29-17"></a>    <span class="p">}</span>
<a id="__codelineno-29-18" name="__codelineno-29-18"></a>
<a id="__codelineno-29-19" name="__codelineno-29-19"></a>
<a id="__codelineno-29-20" name="__codelineno-29-20"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>La couche [UI] est implémentée par le package [spring.core.ui]. Elle présente l'interface [IUi] suivante :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1">1</a></span>
<span class="normal"><a href="#__codelineno-30-2">2</a></span>
<span class="normal"><a href="#__codelineno-30-3">3</a></span>
<span class="normal"><a href="#__codelineno-30-4">4</a></span>
<span class="normal"><a href="#__codelineno-30-5">5</a></span>
<span class="normal"><a href="#__codelineno-30-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1"></a>package spring.core.ui;
<a id="__codelineno-30-2" name="__codelineno-30-2"></a>
<a id="__codelineno-30-3" name="__codelineno-30-3"></a>public interface IUi {
<a id="__codelineno-30-4" name="__codelineno-30-4"></a>
<a id="__codelineno-30-5" name="__codelineno-30-5"></a>    public int doSomethingInUiLayer(int a, int b);
<a id="__codelineno-30-6" name="__codelineno-30-6"></a>}
</code></pre></div></td></tr></table></div>
<p>Cette interface a deux implémentations : [Ui1] et [Ui2] :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-31-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-31-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-31-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-31-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-31-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-31-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-31-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-31-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-31-10">10</a></span>
<span class="normal"><a href="#__codelineno-31-11">11</a></span>
<span class="normal"><a href="#__codelineno-31-12">12</a></span>
<span class="normal"><a href="#__codelineno-31-13">13</a></span>
<span class="normal"><a href="#__codelineno-31-14">14</a></span>
<span class="normal"><a href="#__codelineno-31-15">15</a></span>
<span class="normal"><a href="#__codelineno-31-16">16</a></span>
<span class="normal"><a href="#__codelineno-31-17">17</a></span>
<span class="normal"><a href="#__codelineno-31-18">18</a></span>
<span class="normal"><a href="#__codelineno-31-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1"></a><span class="n">package</span> <span class="n">spring</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">ui</span><span class="p">;</span>
<a id="__codelineno-31-2" name="__codelineno-31-2"></a>
<a id="__codelineno-31-3" name="__codelineno-31-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">spring.core.metier.IMetier</span><span class="p">;</span>
<a id="__codelineno-31-4" name="__codelineno-31-4"></a>
<a id="__codelineno-31-5" name="__codelineno-31-5"></a><span class="n">public</span> <span class="k">class</span><span class="w"> </span><span class="nc">Ui1</span> <span class="n">implements</span> <span class="n">IUi</span> <span class="p">{</span>
<a id="__codelineno-31-6" name="__codelineno-31-6"></a>
<a id="__codelineno-31-7" name="__codelineno-31-7"></a>    <span class="n">private</span> <span class="n">IMetier</span> <span class="n">metier</span><span class="p">;</span>
<a id="__codelineno-31-8" name="__codelineno-31-8"></a>
<a id="__codelineno-31-9" name="__codelineno-31-9"></a>    <span class="n">public</span> <span class="nb">int</span> <span class="n">doSomethingInUiLayer</span><span class="p">(</span><span class="nb">int</span> <span class="n">a</span><span class="p">,</span> <span class="nb">int</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-31-10" name="__codelineno-31-10"></a>        <span class="n">a</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-31-11" name="__codelineno-31-11"></a>        <span class="n">b</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-31-12" name="__codelineno-31-12"></a>        <span class="k">return</span> <span class="n">metier</span><span class="o">.</span><span class="n">doSomethingInMetierLayer</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
<a id="__codelineno-31-13" name="__codelineno-31-13"></a>    <span class="p">}</span>
<a id="__codelineno-31-14" name="__codelineno-31-14"></a>
<a id="__codelineno-31-15" name="__codelineno-31-15"></a>    <span class="n">public</span> <span class="n">void</span> <span class="n">setMetier</span><span class="p">(</span><span class="n">IMetier</span> <span class="n">metier</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-31-16" name="__codelineno-31-16"></a>        <span class="n">this</span><span class="o">.</span><span class="n">metier</span> <span class="o">=</span> <span class="n">metier</span><span class="p">;</span>
<a id="__codelineno-31-17" name="__codelineno-31-17"></a>    <span class="p">}</span>
<a id="__codelineno-31-18" name="__codelineno-31-18"></a>
<a id="__codelineno-31-19" name="__codelineno-31-19"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-32-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-32-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-32-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-32-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-32-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-32-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-32-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-32-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-32-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-32-10">10</a></span>
<span class="normal"><a href="#__codelineno-32-11">11</a></span>
<span class="normal"><a href="#__codelineno-32-12">12</a></span>
<span class="normal"><a href="#__codelineno-32-13">13</a></span>
<span class="normal"><a href="#__codelineno-32-14">14</a></span>
<span class="normal"><a href="#__codelineno-32-15">15</a></span>
<span class="normal"><a href="#__codelineno-32-16">16</a></span>
<span class="normal"><a href="#__codelineno-32-17">17</a></span>
<span class="normal"><a href="#__codelineno-32-18">18</a></span>
<span class="normal"><a href="#__codelineno-32-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1"></a><span class="n">package</span> <span class="n">spring</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">ui</span><span class="p">;</span>
<a id="__codelineno-32-2" name="__codelineno-32-2"></a>
<a id="__codelineno-32-3" name="__codelineno-32-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">spring.core.metier.IMetier</span><span class="p">;</span>
<a id="__codelineno-32-4" name="__codelineno-32-4"></a>
<a id="__codelineno-32-5" name="__codelineno-32-5"></a><span class="n">public</span> <span class="k">class</span><span class="w"> </span><span class="nc">Ui2</span> <span class="n">implements</span> <span class="n">IUi</span> <span class="p">{</span>
<a id="__codelineno-32-6" name="__codelineno-32-6"></a>
<a id="__codelineno-32-7" name="__codelineno-32-7"></a>    <span class="n">private</span> <span class="n">IMetier</span> <span class="n">metier</span><span class="p">;</span>
<a id="__codelineno-32-8" name="__codelineno-32-8"></a>
<a id="__codelineno-32-9" name="__codelineno-32-9"></a>    <span class="n">public</span> <span class="nb">int</span> <span class="n">doSomethingInUiLayer</span><span class="p">(</span><span class="nb">int</span> <span class="n">a</span><span class="p">,</span> <span class="nb">int</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-32-10" name="__codelineno-32-10"></a>        <span class="n">a</span><span class="o">--</span><span class="p">;</span>
<a id="__codelineno-32-11" name="__codelineno-32-11"></a>        <span class="n">b</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-32-12" name="__codelineno-32-12"></a>        <span class="k">return</span> <span class="n">metier</span><span class="o">.</span><span class="n">doSomethingInMetierLayer</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
<a id="__codelineno-32-13" name="__codelineno-32-13"></a>    <span class="p">}</span>
<a id="__codelineno-32-14" name="__codelineno-32-14"></a>
<a id="__codelineno-32-15" name="__codelineno-32-15"></a>    <span class="n">public</span> <span class="n">void</span> <span class="n">setMetier</span><span class="p">(</span><span class="n">IMetier</span> <span class="n">metier</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-32-16" name="__codelineno-32-16"></a>        <span class="n">this</span><span class="o">.</span><span class="n">metier</span> <span class="o">=</span> <span class="n">metier</span><span class="p">;</span>
<a id="__codelineno-32-17" name="__codelineno-32-17"></a>    <span class="p">}</span>
<a id="__codelineno-32-18" name="__codelineno-32-18"></a>
<a id="__codelineno-32-19" name="__codelineno-32-19"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="554-configuration-du-projet-spring">5.5.4. Configuration du projet Spring</h3>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000000E1000000C8B0947CE8.png" style="display:inline-block; margin:4px;width:4.17cm;height:3.701cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr></table>

<p>La classe de configuration [Config] est la suivante :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-33-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-33-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-33-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-33-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-33-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-33-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-33-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-33-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-33-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-33-10">10</a></span>
<span class="normal"><a href="#__codelineno-33-11">11</a></span>
<span class="normal"><a href="#__codelineno-33-12">12</a></span>
<span class="normal"><a href="#__codelineno-33-13">13</a></span>
<span class="normal"><a href="#__codelineno-33-14">14</a></span>
<span class="normal"><a href="#__codelineno-33-15">15</a></span>
<span class="normal"><a href="#__codelineno-33-16">16</a></span>
<span class="normal"><a href="#__codelineno-33-17">17</a></span>
<span class="normal"><a href="#__codelineno-33-18">18</a></span>
<span class="normal"><a href="#__codelineno-33-19">19</a></span>
<span class="normal"><a href="#__codelineno-33-20">20</a></span>
<span class="normal"><a href="#__codelineno-33-21">21</a></span>
<span class="normal"><a href="#__codelineno-33-22">22</a></span>
<span class="normal"><a href="#__codelineno-33-23">23</a></span>
<span class="normal"><a href="#__codelineno-33-24">24</a></span>
<span class="normal"><a href="#__codelineno-33-25">25</a></span>
<span class="normal"><a href="#__codelineno-33-26">26</a></span>
<span class="normal"><a href="#__codelineno-33-27">27</a></span>
<span class="normal"><a href="#__codelineno-33-28">28</a></span>
<span class="normal"><a href="#__codelineno-33-29">29</a></span>
<span class="normal"><a href="#__codelineno-33-30">30</a></span>
<span class="normal"><a href="#__codelineno-33-31">31</a></span>
<span class="normal"><a href="#__codelineno-33-32">32</a></span>
<span class="normal"><a href="#__codelineno-33-33">33</a></span>
<span class="normal"><a href="#__codelineno-33-34">34</a></span>
<span class="normal"><a href="#__codelineno-33-35">35</a></span>
<span class="normal"><a href="#__codelineno-33-36">36</a></span>
<span class="normal"><a href="#__codelineno-33-37">37</a></span>
<span class="normal"><a href="#__codelineno-33-38">38</a></span>
<span class="normal"><a href="#__codelineno-33-39">39</a></span>
<span class="normal"><a href="#__codelineno-33-40">40</a></span>
<span class="normal"><a href="#__codelineno-33-41">41</a></span>
<span class="normal"><a href="#__codelineno-33-42">42</a></span>
<span class="normal"><a href="#__codelineno-33-43">43</a></span>
<span class="normal"><a href="#__codelineno-33-44">44</a></span>
<span class="normal"><a href="#__codelineno-33-45">45</a></span>
<span class="normal"><a href="#__codelineno-33-46">46</a></span>
<span class="normal"><a href="#__codelineno-33-47">47</a></span>
<span class="normal"><a href="#__codelineno-33-48">48</a></span>
<span class="normal"><a href="#__codelineno-33-49">49</a></span>
<span class="normal"><a href="#__codelineno-33-50">50</a></span>
<span class="normal"><a href="#__codelineno-33-51">51</a></span>
<span class="normal"><a href="#__codelineno-33-52">52</a></span>
<span class="normal"><a href="#__codelineno-33-53">53</a></span>
<span class="normal"><a href="#__codelineno-33-54">54</a></span>
<span class="normal"><a href="#__codelineno-33-55">55</a></span>
<span class="normal"><a href="#__codelineno-33-56">56</a></span>
<span class="normal"><a href="#__codelineno-33-57">57</a></span>
<span class="normal"><a href="#__codelineno-33-58">58</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1"></a><span class="n">package</span> <span class="n">spring</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">config</span><span class="p">;</span>
<a id="__codelineno-33-2" name="__codelineno-33-2"></a>
<a id="__codelineno-33-3" name="__codelineno-33-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Bean</span><span class="p">;</span>
<a id="__codelineno-33-4" name="__codelineno-33-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Configuration</span><span class="p">;</span>
<a id="__codelineno-33-5" name="__codelineno-33-5"></a>
<a id="__codelineno-33-6" name="__codelineno-33-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">spring.core.dao.Dao1</span><span class="p">;</span>
<a id="__codelineno-33-7" name="__codelineno-33-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">spring.core.dao.Dao2</span><span class="p">;</span>
<a id="__codelineno-33-8" name="__codelineno-33-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">spring.core.dao.IDao</span><span class="p">;</span>
<a id="__codelineno-33-9" name="__codelineno-33-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">spring.core.metier.IMetier</span><span class="p">;</span>
<a id="__codelineno-33-10" name="__codelineno-33-10"></a><span class="kn">import</span><span class="w"> </span><span class="nn">spring.core.metier.Metier1</span><span class="p">;</span>
<a id="__codelineno-33-11" name="__codelineno-33-11"></a><span class="kn">import</span><span class="w"> </span><span class="nn">spring.core.metier.Metier2</span><span class="p">;</span>
<a id="__codelineno-33-12" name="__codelineno-33-12"></a><span class="kn">import</span><span class="w"> </span><span class="nn">spring.core.ui.IUi</span><span class="p">;</span>
<a id="__codelineno-33-13" name="__codelineno-33-13"></a><span class="kn">import</span><span class="w"> </span><span class="nn">spring.core.ui.Ui1</span><span class="p">;</span>
<a id="__codelineno-33-14" name="__codelineno-33-14"></a><span class="kn">import</span><span class="w"> </span><span class="nn">spring.core.ui.Ui2</span><span class="p">;</span>
<a id="__codelineno-33-15" name="__codelineno-33-15"></a>
<a id="__codelineno-33-16" name="__codelineno-33-16"></a><span class="nd">@Configuration</span>
<a id="__codelineno-33-17" name="__codelineno-33-17"></a><span class="n">public</span> <span class="k">class</span><span class="w"> </span><span class="nc">Config</span> <span class="p">{</span>
<a id="__codelineno-33-18" name="__codelineno-33-18"></a>
<a id="__codelineno-33-19" name="__codelineno-33-19"></a>    <span class="o">//</span> <span class="o">--------------</span> <span class="n">implémentation</span> <span class="p">[</span><span class="n">Ui1</span><span class="p">,</span> <span class="n">Metier1</span><span class="p">,</span> <span class="n">Dao1</span><span class="p">]</span>
<a id="__codelineno-33-20" name="__codelineno-33-20"></a>    <span class="nd">@Bean</span>
<a id="__codelineno-33-21" name="__codelineno-33-21"></a>    <span class="n">public</span> <span class="n">IDao</span> <span class="n">dao1</span><span class="p">()</span> <span class="p">{</span>
<a id="__codelineno-33-22" name="__codelineno-33-22"></a>        <span class="k">return</span> <span class="n">new</span> <span class="n">Dao1</span><span class="p">();</span>
<a id="__codelineno-33-23" name="__codelineno-33-23"></a>    <span class="p">}</span>
<a id="__codelineno-33-24" name="__codelineno-33-24"></a>
<a id="__codelineno-33-25" name="__codelineno-33-25"></a>    <span class="nd">@Bean</span>
<a id="__codelineno-33-26" name="__codelineno-33-26"></a>    <span class="n">public</span> <span class="n">IMetier</span> <span class="n">metier1</span><span class="p">(</span><span class="n">IDao</span> <span class="n">dao1</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-33-27" name="__codelineno-33-27"></a>        <span class="n">Metier1</span> <span class="n">metier</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Metier1</span><span class="p">();</span>
<a id="__codelineno-33-28" name="__codelineno-33-28"></a>        <span class="n">metier</span><span class="o">.</span><span class="n">setDao</span><span class="p">(</span><span class="n">dao1</span><span class="p">);</span>
<a id="__codelineno-33-29" name="__codelineno-33-29"></a>        <span class="k">return</span> <span class="n">metier</span><span class="p">;</span>
<a id="__codelineno-33-30" name="__codelineno-33-30"></a>    <span class="p">}</span>
<a id="__codelineno-33-31" name="__codelineno-33-31"></a>
<a id="__codelineno-33-32" name="__codelineno-33-32"></a>    <span class="nd">@Bean</span>
<a id="__codelineno-33-33" name="__codelineno-33-33"></a>    <span class="n">public</span> <span class="n">IUi</span> <span class="n">ui1</span><span class="p">(</span><span class="n">IMetier</span> <span class="n">metier1</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-33-34" name="__codelineno-33-34"></a>        <span class="n">Ui1</span> <span class="n">ui</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Ui1</span><span class="p">();</span>
<a id="__codelineno-33-35" name="__codelineno-33-35"></a>        <span class="n">ui</span><span class="o">.</span><span class="n">setMetier</span><span class="p">(</span><span class="n">metier1</span><span class="p">);</span>
<a id="__codelineno-33-36" name="__codelineno-33-36"></a>        <span class="k">return</span> <span class="n">ui</span><span class="p">;</span>
<a id="__codelineno-33-37" name="__codelineno-33-37"></a>    <span class="p">}</span>
<a id="__codelineno-33-38" name="__codelineno-33-38"></a>
<a id="__codelineno-33-39" name="__codelineno-33-39"></a>    <span class="o">//</span> <span class="o">--------------</span> <span class="n">implémentation</span> <span class="p">[</span><span class="n">Ui2</span><span class="p">,</span> <span class="n">Metier2</span><span class="p">,</span> <span class="n">Dao2</span><span class="p">]</span>
<a id="__codelineno-33-40" name="__codelineno-33-40"></a>    <span class="nd">@Bean</span>
<a id="__codelineno-33-41" name="__codelineno-33-41"></a>    <span class="n">public</span> <span class="n">IDao</span> <span class="n">dao2</span><span class="p">()</span> <span class="p">{</span>
<a id="__codelineno-33-42" name="__codelineno-33-42"></a>        <span class="k">return</span> <span class="n">new</span> <span class="n">Dao2</span><span class="p">();</span>
<a id="__codelineno-33-43" name="__codelineno-33-43"></a>    <span class="p">}</span>
<a id="__codelineno-33-44" name="__codelineno-33-44"></a>
<a id="__codelineno-33-45" name="__codelineno-33-45"></a>    <span class="nd">@Bean</span>
<a id="__codelineno-33-46" name="__codelineno-33-46"></a>    <span class="n">public</span> <span class="n">IMetier</span> <span class="n">metier2</span><span class="p">(</span><span class="n">IDao</span> <span class="n">dao2</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-33-47" name="__codelineno-33-47"></a>        <span class="n">Metier2</span> <span class="n">metier</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Metier2</span><span class="p">();</span>
<a id="__codelineno-33-48" name="__codelineno-33-48"></a>        <span class="n">metier</span><span class="o">.</span><span class="n">setDao</span><span class="p">(</span><span class="n">dao2</span><span class="p">);</span>
<a id="__codelineno-33-49" name="__codelineno-33-49"></a>        <span class="k">return</span> <span class="n">metier</span><span class="p">;</span>
<a id="__codelineno-33-50" name="__codelineno-33-50"></a>    <span class="p">}</span>
<a id="__codelineno-33-51" name="__codelineno-33-51"></a>
<a id="__codelineno-33-52" name="__codelineno-33-52"></a>    <span class="nd">@Bean</span>
<a id="__codelineno-33-53" name="__codelineno-33-53"></a>    <span class="n">public</span> <span class="n">IUi</span> <span class="n">ui2</span><span class="p">(</span><span class="n">IMetier</span> <span class="n">metier2</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-33-54" name="__codelineno-33-54"></a>        <span class="n">Ui2</span> <span class="n">ui</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Ui2</span><span class="p">();</span>
<a id="__codelineno-33-55" name="__codelineno-33-55"></a>        <span class="n">ui</span><span class="o">.</span><span class="n">setMetier</span><span class="p">(</span><span class="n">metier2</span><span class="p">);</span>
<a id="__codelineno-33-56" name="__codelineno-33-56"></a>        <span class="k">return</span> <span class="n">ui</span><span class="p">;</span>
<a id="__codelineno-33-57" name="__codelineno-33-57"></a>    <span class="p">}</span>
<a id="__codelineno-33-58" name="__codelineno-33-58"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>lignes 20-23 : le bean nommé [dao1] (nom de la méthode) est une instance de la classe [Dao1] (ligne 22) considérée comme une implémentation de l'interface [IDao] (ligne 21). Le bean [dao1] est donc vu comme une instance d'interface (la terminologie est incorrecte mais elle peut se comprendre) et non une instance de classe. C'est un point important à comprendre. Tous les autres beans vont être eux aussi des instances d'interfaces ;</li>
<li>lignes 25-30 : une instance de l'interface [IMetier] implémentée par la classe [Metier1] ;</li>
<li>lignes 32-37 : une instance de l'interface [IUi] implémentée par la classe [Ui1] ;</li>
<li>lignes 20-37 : implémentent les couches [UI, Metier, DAO] avec des instances [Ui1, Metier1, Dao1] ;</li>
<li>lignes 40-57 : implémentent les couches [UI, Metier, DAO] avec des instances [Ui2, Metier2, Dao2] ;</li>
</ul>
<h3 id="555-test-unitaire-junittest">5.5.5. Test unitaire [JUnitTest]</h3>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000000E5000000ED0A9D7A57.png" style="display:inline-block; margin:4px;width:4.24cm;height:4.39cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr></table>

<p>La classe [JUnitTest] est mise dans la branche [src / test / java] du projet Maven. Les éléments de cette branche ne sont pas placés dans l'archive finale du projet. Son code est le suivant :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-34-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-34-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-34-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-34-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-34-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-34-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-34-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-34-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-34-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-34-10">10</a></span>
<span class="normal"><a href="#__codelineno-34-11">11</a></span>
<span class="normal"><a href="#__codelineno-34-12">12</a></span>
<span class="normal"><a href="#__codelineno-34-13">13</a></span>
<span class="normal"><a href="#__codelineno-34-14">14</a></span>
<span class="normal"><a href="#__codelineno-34-15">15</a></span>
<span class="normal"><a href="#__codelineno-34-16">16</a></span>
<span class="normal"><a href="#__codelineno-34-17">17</a></span>
<span class="normal"><a href="#__codelineno-34-18">18</a></span>
<span class="normal"><a href="#__codelineno-34-19">19</a></span>
<span class="normal"><a href="#__codelineno-34-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1"></a><span class="n">package</span> <span class="n">spring</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">tests</span><span class="p">;</span>
<a id="__codelineno-34-2" name="__codelineno-34-2"></a>
<a id="__codelineno-34-3" name="__codelineno-34-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.Assert</span><span class="p">;</span>
<a id="__codelineno-34-4" name="__codelineno-34-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.Test</span><span class="p">;</span>
<a id="__codelineno-34-5" name="__codelineno-34-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.runner.RunWith</span><span class="p">;</span>
<a id="__codelineno-34-6" name="__codelineno-34-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>
<a id="__codelineno-34-7" name="__codelineno-34-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.beans.factory.annotation.Qualifier</span><span class="p">;</span>
<a id="__codelineno-34-8" name="__codelineno-34-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.boot.test.SpringApplicationConfiguration</span><span class="p">;</span>
<a id="__codelineno-34-9" name="__codelineno-34-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.test.context.junit4.SpringJUnit4ClassRunner</span><span class="p">;</span>
<a id="__codelineno-34-10" name="__codelineno-34-10"></a>
<a id="__codelineno-34-11" name="__codelineno-34-11"></a><span class="kn">import</span><span class="w"> </span><span class="nn">spring.core.config.Config</span><span class="p">;</span>
<a id="__codelineno-34-12" name="__codelineno-34-12"></a><span class="kn">import</span><span class="w"> </span><span class="nn">spring.core.dao.IDao</span><span class="p">;</span>
<a id="__codelineno-34-13" name="__codelineno-34-13"></a><span class="kn">import</span><span class="w"> </span><span class="nn">spring.core.metier.IMetier</span><span class="p">;</span>
<a id="__codelineno-34-14" name="__codelineno-34-14"></a><span class="kn">import</span><span class="w"> </span><span class="nn">spring.core.ui.IUi</span><span class="p">;</span>
<a id="__codelineno-34-15" name="__codelineno-34-15"></a>
<a id="__codelineno-34-16" name="__codelineno-34-16"></a><span class="nd">@SpringApplicationConfiguration</span><span class="p">(</span><span class="n">classes</span> <span class="o">=</span> <span class="p">{</span> <span class="n">Config</span><span class="o">.</span><span class="k">class</span><span class="w"> </span><span class="err">})</span>
<a id="__codelineno-34-17" name="__codelineno-34-17"></a><span class="nd">@RunWith</span><span class="p">(</span><span class="n">SpringJUnit4ClassRunner</span><span class="o">.</span><span class="n">class</span><span class="p">)</span>
<a id="__codelineno-34-18" name="__codelineno-34-18"></a><span class="n">public</span> <span class="k">class</span><span class="w"> </span><span class="nc">JUnitTest</span> <span class="p">{</span>
<a id="__codelineno-34-19" name="__codelineno-34-19"></a><span class="o">...</span>
<a id="__codelineno-34-20" name="__codelineno-34-20"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 16 : l'annotation [@SpringApplicationConfiguration] est une annotation du projet Spring Boot Test (ligne 8). Elle est amenée par la dépendance suivante du fichier [pom.xml] :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-35-1">1</a></span>
<span class="normal"><a href="#__codelineno-35-2">2</a></span>
<span class="normal"><a href="#__codelineno-35-3">3</a></span>
<span class="normal"><a href="#__codelineno-35-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1"></a>        &lt;dependency&gt;
<a id="__codelineno-35-2" name="__codelineno-35-2"></a>            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
<a id="__codelineno-35-3" name="__codelineno-35-3"></a>            &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;
<a id="__codelineno-35-4" name="__codelineno-35-4"></a>&lt;/dependency&gt;
</code></pre></div></td></tr></table></div>
<p>Cette annotation a pour paramètre la liste des classes de configuration à utiliser pour construire le contexte Spring nécessaire au test. Ici nous utilisons la classe de configuration [Config] déjà présentée ;</p>
<ul>
<li>ligne 17 : l'annotation [@RunWith] est une annotation JUnit (ligne 5). Son paramètre est la classe chargée de conduire les tests à la place de la classe par défaut du framework Junit. Cette classe est une classe Spring (ligne 9). Elle va utiliser les annotations Spring présentes dans la classe de test ;</li>
</ul>
<p>La classe complète est la suivante</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-36-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-36-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-36-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-36-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-36-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-36-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-36-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-36-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-36-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-36-10">10</a></span>
<span class="normal"><a href="#__codelineno-36-11">11</a></span>
<span class="normal"><a href="#__codelineno-36-12">12</a></span>
<span class="normal"><a href="#__codelineno-36-13">13</a></span>
<span class="normal"><a href="#__codelineno-36-14">14</a></span>
<span class="normal"><a href="#__codelineno-36-15">15</a></span>
<span class="normal"><a href="#__codelineno-36-16">16</a></span>
<span class="normal"><a href="#__codelineno-36-17">17</a></span>
<span class="normal"><a href="#__codelineno-36-18">18</a></span>
<span class="normal"><a href="#__codelineno-36-19">19</a></span>
<span class="normal"><a href="#__codelineno-36-20">20</a></span>
<span class="normal"><a href="#__codelineno-36-21">21</a></span>
<span class="normal"><a href="#__codelineno-36-22">22</a></span>
<span class="normal"><a href="#__codelineno-36-23">23</a></span>
<span class="normal"><a href="#__codelineno-36-24">24</a></span>
<span class="normal"><a href="#__codelineno-36-25">25</a></span>
<span class="normal"><a href="#__codelineno-36-26">26</a></span>
<span class="normal"><a href="#__codelineno-36-27">27</a></span>
<span class="normal"><a href="#__codelineno-36-28">28</a></span>
<span class="normal"><a href="#__codelineno-36-29">29</a></span>
<span class="normal"><a href="#__codelineno-36-30">30</a></span>
<span class="normal"><a href="#__codelineno-36-31">31</a></span>
<span class="normal"><a href="#__codelineno-36-32">32</a></span>
<span class="normal"><a href="#__codelineno-36-33">33</a></span>
<span class="normal"><a href="#__codelineno-36-34">34</a></span>
<span class="normal"><a href="#__codelineno-36-35">35</a></span>
<span class="normal"><a href="#__codelineno-36-36">36</a></span>
<span class="normal"><a href="#__codelineno-36-37">37</a></span>
<span class="normal"><a href="#__codelineno-36-38">38</a></span>
<span class="normal"><a href="#__codelineno-36-39">39</a></span>
<span class="normal"><a href="#__codelineno-36-40">40</a></span>
<span class="normal"><a href="#__codelineno-36-41">41</a></span>
<span class="normal"><a href="#__codelineno-36-42">42</a></span>
<span class="normal"><a href="#__codelineno-36-43">43</a></span>
<span class="normal"><a href="#__codelineno-36-44">44</a></span>
<span class="normal"><a href="#__codelineno-36-45">45</a></span>
<span class="normal"><a href="#__codelineno-36-46">46</a></span>
<span class="normal"><a href="#__codelineno-36-47">47</a></span>
<span class="normal"><a href="#__codelineno-36-48">48</a></span>
<span class="normal"><a href="#__codelineno-36-49">49</a></span>
<span class="normal"><a href="#__codelineno-36-50">50</a></span>
<span class="normal"><a href="#__codelineno-36-51">51</a></span>
<span class="normal"><a href="#__codelineno-36-52">52</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1"></a>...
<a id="__codelineno-36-2" name="__codelineno-36-2"></a>
<a id="__codelineno-36-3" name="__codelineno-36-3"></a>@SpringApplicationConfiguration(classes = { Config.class })
<a id="__codelineno-36-4" name="__codelineno-36-4"></a>@RunWith(SpringJUnit4ClassRunner.class)
<a id="__codelineno-36-5" name="__codelineno-36-5"></a>public class JUnitTest {
<a id="__codelineno-36-6" name="__codelineno-36-6"></a>
<a id="__codelineno-36-7" name="__codelineno-36-7"></a>    // couche [UI]
<a id="__codelineno-36-8" name="__codelineno-36-8"></a>    @Autowired
<a id="__codelineno-36-9" name="__codelineno-36-9"></a>    @Qualifier(&quot;ui1&quot;)
<a id="__codelineno-36-10" name="__codelineno-36-10"></a>    private IUi ui1;
<a id="__codelineno-36-11" name="__codelineno-36-11"></a>
<a id="__codelineno-36-12" name="__codelineno-36-12"></a>    @Autowired
<a id="__codelineno-36-13" name="__codelineno-36-13"></a>    @Qualifier(&quot;ui2&quot;)
<a id="__codelineno-36-14" name="__codelineno-36-14"></a>    private IUi ui2;
<a id="__codelineno-36-15" name="__codelineno-36-15"></a>
<a id="__codelineno-36-16" name="__codelineno-36-16"></a>    // couche [métier]
<a id="__codelineno-36-17" name="__codelineno-36-17"></a>    @Autowired
<a id="__codelineno-36-18" name="__codelineno-36-18"></a>    @Qualifier(&quot;metier1&quot;)
<a id="__codelineno-36-19" name="__codelineno-36-19"></a>    private IMetier metier1;
<a id="__codelineno-36-20" name="__codelineno-36-20"></a>
<a id="__codelineno-36-21" name="__codelineno-36-21"></a>    @Autowired
<a id="__codelineno-36-22" name="__codelineno-36-22"></a>    @Qualifier(&quot;metier2&quot;)
<a id="__codelineno-36-23" name="__codelineno-36-23"></a>    private IMetier metier2;
<a id="__codelineno-36-24" name="__codelineno-36-24"></a>
<a id="__codelineno-36-25" name="__codelineno-36-25"></a>    // couche [dao]
<a id="__codelineno-36-26" name="__codelineno-36-26"></a>    @Autowired
<a id="__codelineno-36-27" name="__codelineno-36-27"></a>    @Qualifier(&quot;dao1&quot;)
<a id="__codelineno-36-28" name="__codelineno-36-28"></a>    private IDao dao1;
<a id="__codelineno-36-29" name="__codelineno-36-29"></a>
<a id="__codelineno-36-30" name="__codelineno-36-30"></a>    @Autowired
<a id="__codelineno-36-31" name="__codelineno-36-31"></a>    @Qualifier(&quot;dao2&quot;)
<a id="__codelineno-36-32" name="__codelineno-36-32"></a>    private IDao dao2;
<a id="__codelineno-36-33" name="__codelineno-36-33"></a>
<a id="__codelineno-36-34" name="__codelineno-36-34"></a>    @Test
<a id="__codelineno-36-35" name="__codelineno-36-35"></a>    public void testDao() {
<a id="__codelineno-36-36" name="__codelineno-36-36"></a>        Assert.assertEquals(30, dao1.doSomethingInDaoLayer(10, 20));
<a id="__codelineno-36-37" name="__codelineno-36-37"></a>        Assert.assertEquals(-10, dao2.doSomethingInDaoLayer(10, 20));
<a id="__codelineno-36-38" name="__codelineno-36-38"></a>    }
<a id="__codelineno-36-39" name="__codelineno-36-39"></a>
<a id="__codelineno-36-40" name="__codelineno-36-40"></a>    @Test
<a id="__codelineno-36-41" name="__codelineno-36-41"></a>    public void testMetier() {
<a id="__codelineno-36-42" name="__codelineno-36-42"></a>        Assert.assertEquals(32, metier1.doSomethingInMetierLayer(10, 20));
<a id="__codelineno-36-43" name="__codelineno-36-43"></a>        Assert.assertEquals(-12, metier2.doSomethingInMetierLayer(10, 20));
<a id="__codelineno-36-44" name="__codelineno-36-44"></a>    }
<a id="__codelineno-36-45" name="__codelineno-36-45"></a>
<a id="__codelineno-36-46" name="__codelineno-36-46"></a>    @Test
<a id="__codelineno-36-47" name="__codelineno-36-47"></a>    public void testUI() {
<a id="__codelineno-36-48" name="__codelineno-36-48"></a>        Assert.assertEquals(34, ui1.doSomethingInUiLayer(10, 20));
<a id="__codelineno-36-49" name="__codelineno-36-49"></a>        Assert.assertEquals(-14, ui2.doSomethingInUiLayer(10, 20));
<a id="__codelineno-36-50" name="__codelineno-36-50"></a>    }
<a id="__codelineno-36-51" name="__codelineno-36-51"></a>
<a id="__codelineno-36-52" name="__codelineno-36-52"></a>}
</code></pre></div></td></tr></table></div>
<ul>
<li>lignes 8-10 : on injecte (ligne 8) le bean nommé (ligne 9) [ui1]. On remarquera ligne 10 qu'on injecte une instance d'interface et non une instance de classe ;</li>
<li>lignes 21-32 : on injecte de la même façon les autres beans définis dans la classe [Config] ;</li>
<li>ligne 34 : l'annotation [@Test] désigne une méthode à exécuter au cours des tests. Les autres annotations possibles sont les suivantes :</li>
<li>[@BeforeClass] : méthode à exécuter avant de commencer les tests ;</li>
<li>[@AfterClass] : méthode à exécuter une fois tous les tests faits ;</li>
<li>[@Before] : méthode à exécuter <strong>avant</strong> <strong>chaque</strong> test ;</li>
<li>[@After] : méthode à exécuter <strong>après chaque</strong> test ;</li>
<li>line 36 : on vérifie que l'appel [dao1.doSomethingInDaoLayer(10, 20)] rend bien 30. Le premier paramètre est par convention, la valeur attendue et le second la valeur réelle ;</li>
<li>ligne 36 : teste l'instance [dao1] de l'interface [IDao] ;</li>
<li>ligne 37 : teste l'instance [dao2] de l'interface [IDao] ;</li>
<li>ligne 42 : teste l'instance [metier1] de l'interface [IMetier] ;</li>
<li>ligne 43 : teste l'instance [metier2] de l'interface [IMetier] ;</li>
<li>ligne 48 : teste l'instance [ui1] de l'interface [IUi] ;</li>
<li>ligne 36 : teste l'instance [ui2] de l'interface [IUi] ;</li>
</ul>
<p>Les assertions utilisables dans une méthode de test sont les suivantes :</p>
<ul>
<li><strong>assertEquals(expression1, expression2)</strong> : vérifie que les valeurs des deux expressions sont égales. De nombreux types d'expression sont acceptés (int, String, float, double, boolean, char, short). Si les deux expressions ne sont pas égales, alors une exception de type [AssertionFailedError ] est lancée,</li>
<li><strong>assertEquals(réel1, réel2, delta)</strong> : vérifie que deux réels sont égaux à <strong>delta</strong> près, c.a.d abs(réel1-réel2)&lt;=delta. On pourra écrire par exemple <strong>assertEquals(réel1, réel2, 1E-6)</strong> pour vérifier que deux valeurs sont égales à 10-6 près,</li>
<li><strong>assertEquals(message, expression1, expression2)</strong> et <strong>assertEquals(message, réel1, réel2, delta)</strong> sont des variantes permettant de préciser le message d'erreur à associer à l'exception  de type [AssertionFailedError] lancée lorsque la méthode [assertEquals] échoue,</li>
<li><strong>assertNotNull(Object)</strong> et <strong>assertNotNull(message, Object) </strong>: vérifie que la référence <strong>Object</strong> n'est pas égale à <strong>null,</strong></li>
<li><strong>assertNull(Object)</strong> et <strong>assertNull(message, Object) </strong>: vérifie que la référence <strong>Object</strong> est égale à <strong>null,</strong></li>
<li><strong>assertSame(Object1, Object2)</strong> et <strong>assertSame(message, Object1, Object2)</strong> : vérifie que les références <strong>Object1</strong> et <strong>Object2</strong> pointent sur le même objet,</li>
<li><strong>assertNotSame(Object1, Object2)</strong> et <strong>assertNotSame(message, Object1, Object2)</strong> : vérifie que les références <strong>Object1</strong> et <strong>Object2</strong> ne pointent pas sur le même objet ;</li>
</ul>
<p>Pour exécuter le test, on peut procéder de la façon suivante :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000041B00000484D9A1D990.png" style="display:inline-block; margin:4px;width:13.905cm;height:15.293cm;" /></td></tr></table>

<p>On obtient le résultat suivant :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000017400000124C99CC553.png" style="display:inline-block; margin:4px;width:6.89cm;height:5.41cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr></table>

<p>Ici tous les test ont réussi. Au fait que montre cet exemple ? Il montre la souplesse apportée par le framework Spring dans la configuration d'une architecture en couches. On peut décider d'utiliser l'implémentation [Ui1, Metier1, Dao1] ou [Ui2, Metier2, Dao2] simplement par configuration. Ainsi dans le test JUnit précédent, si on ne garde que l'injection des beans [ui1, metier1, dao1] on travaille avec la 1ère architecture. Pour changer d'architecture, il suffit de changer les beans injectés. Cela se fait sans changement de code des couches implémentant les interfaces. On appelle ce type de programmation, programmation par interfaces car on n'utilise pas les instances des classes implémentant les couches mais les instances de leurs interfaces.</p>
<h2 id="56-conclusion">5.6. Conclusion</h2>
<ul>
<li>Spring gère des objets qui sont des singletons (un seul exemplaire). Spring gère également des objets qui sont instanciés à chaque fois qu'on en demande une instance à Spring. Ce cas sera également présenté dans ce document ;</li>
<li>ces objets peuvent être déclarés de diverses façons qui peuvent être mixées :</li>
<li>dans un fichier XML,</li>
<li>dans une classe Java annotée par [@Configuration],</li>
<li>avec n'importe quelle classe Java annotée par [@Component, @Service, ...] ;</li>
<li>un objet Spring peut être injecté dans un autre objet Spring avec l'annotation [@Autowired]. On parle alors d'injection de dépendances (DI : Dependency Injection) ;</li>
<li>Spring se montre très pratique pour configurer des architectures en couches avec l'utilisation conjointe du paradigme de de la programmation par interfaces ;</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner">

      <div>
        <a href="https://tahe.developpez.com" target="_blank">
          https://tahe.developpez.com
        </a>
        <br>
        Ce cours tutoriel écrit par <strong>Serge Tahé</strong> est mis à disposition du public selon les termes de la
        <em>Licence Creative Commons Attribution – Pas d’Utilisation Commerciale –
        Partage dans les Mêmes Conditions 3.0 non transposé</em>.
      </div>

    </div>
  </div>

      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": ".", "features": ["navigation.sections", "navigation.indexes", "navigation.expand", "toc.integrate", "navigation.top"], "search": "assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="javascripts/focus.js"></script>
      
    
  </body>
</html>